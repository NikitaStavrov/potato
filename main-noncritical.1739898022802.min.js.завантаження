/*! jQuery Migrate v3.4.1 | (c) OpenJS Foundation and other contributors | jquery.org/license */
"undefined"==typeof jQuery.migrateMute&&(jQuery.migrateMute=!0),function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],function(e){return t(e,window)}):"object"==typeof module&&module.exports?module.exports=t(require("jquery"),window):t(jQuery,window)}(function(s,n){"use strict";function e(e){return 0<=function(e,t){for(var r=/^(\d+)\.(\d+)\.(\d+)/,n=r.exec(e)||[],o=r.exec(t)||[],a=1;a<=3;a++){if(+o[a]<+n[a])return 1;if(+n[a]<+o[a])return-1}return 0}(s.fn.jquery,e)}s.migrateVersion="3.4.1";var t=Object.create(null);s.migrateDisablePatches=function(){for(var e=0;e<arguments.length;e++)t[arguments[e]]=!0},s.migrateEnablePatches=function(){for(var e=0;e<arguments.length;e++)delete t[arguments[e]]},s.migrateIsPatchEnabled=function(e){return!t[e]},n.console&&n.console.log&&(s&&e("3.0.0")&&!e("5.0.0")||n.console.log("JQMIGRATE: jQuery 3.x-4.x REQUIRED"),s.migrateWarnings&&n.console.log("JQMIGRATE: Migrate plugin loaded multiple times"),n.console.log("JQMIGRATE: Migrate is installed"+(s.migrateMute?"":" with logging active")+", version "+s.migrateVersion));var o={};function u(e,t){var r=n.console;!s.migrateIsPatchEnabled(e)||s.migrateDeduplicateWarnings&&o[t]||(o[t]=!0,s.migrateWarnings.push(t+" ["+e+"]"),r&&r.warn&&!s.migrateMute&&(r.warn("JQMIGRATE: "+t),s.migrateTrace&&r.trace&&r.trace()))}function r(e,t,r,n,o){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:function(){return u(n,o),r},set:function(e){u(n,o),r=e}})}function a(e,t,r,n,o){var a=e[t];e[t]=function(){return o&&u(n,o),(s.migrateIsPatchEnabled(n)?r:a||s.noop).apply(this,arguments)}}function c(e,t,r,n,o){if(!o)throw new Error("No warning message provided");return a(e,t,r,n,o),0}function i(e,t,r,n){return a(e,t,r,n),0}s.migrateDeduplicateWarnings=!0,s.migrateWarnings=[],void 0===s.migrateTrace&&(s.migrateTrace=!0),s.migrateReset=function(){o={},s.migrateWarnings.length=0},"BackCompat"===n.document.compatMode&&u("quirks","jQuery is not compatible with Quirks Mode");var d,l,p,f={},m=s.fn.init,y=s.find,h=/\[(\s*[-\w]+\s*)([~|^$*]?=)\s*([-\w#]*?#[-\w#]*)\s*\]/,g=/\[(\s*[-\w]+\s*)([~|^$*]?=)\s*([-\w#]*?#[-\w#]*)\s*\]/g,v=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;for(d in i(s.fn,"init",function(e){var t=Array.prototype.slice.call(arguments);return s.migrateIsPatchEnabled("selector-empty-id")&&"string"==typeof e&&"#"===e&&(u("selector-empty-id","jQuery( '#' ) is not a valid selector"),t[0]=[]),m.apply(this,t)},"selector-empty-id"),s.fn.init.prototype=s.fn,i(s,"find",function(t){var r=Array.prototype.slice.call(arguments);if("string"==typeof t&&h.test(t))try{n.document.querySelector(t)}catch(e){t=t.replace(g,function(e,t,r,n){return"["+t+r+'"'+n+'"]'});try{n.document.querySelector(t),u("selector-hash","Attribute selector with '#' must be quoted: "+r[0]),r[0]=t}catch(e){u("selector-hash","Attribute selector with '#' was not fixed: "+r[0])}}return y.apply(this,r)},"selector-hash"),y)Object.prototype.hasOwnProperty.call(y,d)&&(s.find[d]=y[d]);c(s.fn,"size",function(){return this.length},"size","jQuery.fn.size() is deprecated and removed; use the .length property"),c(s,"parseJSON",function(){return JSON.parse.apply(null,arguments)},"parseJSON","jQuery.parseJSON is deprecated; use JSON.parse"),c(s,"holdReady",s.holdReady,"holdReady","jQuery.holdReady is deprecated"),c(s,"unique",s.uniqueSort,"unique","jQuery.unique is deprecated; use jQuery.uniqueSort"),r(s.expr,"filters",s.expr.pseudos,"expr-pre-pseudos","jQuery.expr.filters is deprecated; use jQuery.expr.pseudos"),r(s.expr,":",s.expr.pseudos,"expr-pre-pseudos","jQuery.expr[':'] is deprecated; use jQuery.expr.pseudos"),e("3.1.1")&&c(s,"trim",function(e){return null==e?"":(e+"").replace(v,"$1")},"trim","jQuery.trim is deprecated; use String.prototype.trim"),e("3.2.0")&&(c(s,"nodeName",function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},"nodeName","jQuery.nodeName is deprecated"),c(s,"isArray",Array.isArray,"isArray","jQuery.isArray is deprecated; use Array.isArray")),e("3.3.0")&&(c(s,"isNumeric",function(e){var t=typeof e;return("number"==t||"string"==t)&&!isNaN(e-parseFloat(e))},"isNumeric","jQuery.isNumeric() is deprecated"),s.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){f["[object "+t+"]"]=t.toLowerCase()}),c(s,"type",function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?f[Object.prototype.toString.call(e)]||"object":typeof e},"type","jQuery.type is deprecated"),c(s,"isFunction",function(e){return"function"==typeof e},"isFunction","jQuery.isFunction() is deprecated"),c(s,"isWindow",function(e){return null!=e&&e===e.window},"isWindow","jQuery.isWindow() is deprecated")),s.ajax&&(l=s.ajax,p=/(=)\?(?=&|$)|\?\?/,i(s,"ajax",function(){var e=l.apply(this,arguments);return e.promise&&(c(e,"success",e.done,"jqXHR-methods","jQXHR.success is deprecated and removed"),c(e,"error",e.fail,"jqXHR-methods","jQXHR.error is deprecated and removed"),c(e,"complete",e.always,"jqXHR-methods","jQXHR.complete is deprecated and removed")),e},"jqXHR-methods"),e("4.0.0")||s.ajaxPrefilter("+json",function(e){!1!==e.jsonp&&(p.test(e.url)||"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&p.test(e.data))&&u("jsonp-promotion","JSON-to-JSONP auto-promotion is deprecated")}));var j=s.fn.removeAttr,b=s.fn.toggleClass,w=/\S+/g;function x(e){return e.replace(/-([a-z])/g,function(e,t){return t.toUpperCase()})}i(s.fn,"removeAttr",function(e){var r=this,n=!1;return s.each(e.match(w),function(e,t){s.expr.match.bool.test(t)&&r.each(function(){if(!1!==s(this).prop(t))return!(n=!0)}),n&&(u("removeAttr-bool","jQuery.fn.removeAttr no longer sets boolean properties: "+t),r.prop(t,!1))}),j.apply(this,arguments)},"removeAttr-bool"),i(s.fn,"toggleClass",function(t){return void 0!==t&&"boolean"!=typeof t?b.apply(this,arguments):(u("toggleClass-bool","jQuery.fn.toggleClass( boolean ) is deprecated"),this.each(function(){var e=this.getAttribute&&this.getAttribute("class")||"";e&&s.data(this,"__className__",e),this.setAttribute&&this.setAttribute("class",!e&&!1!==t&&s.data(this,"__className__")||"")}))},"toggleClass-bool");var Q,A,R=!1,C=/^[a-z]/,N=/^(?:Border(?:Top|Right|Bottom|Left)?(?:Width|)|(?:Margin|Padding)?(?:Top|Right|Bottom|Left)?|(?:Min|Max)?(?:Width|Height))$/;s.swap&&s.each(["height","width","reliableMarginRight"],function(e,t){var r=s.cssHooks[t]&&s.cssHooks[t].get;r&&(s.cssHooks[t].get=function(){var e;return R=!0,e=r.apply(this,arguments),R=!1,e})}),i(s,"swap",function(e,t,r,n){var o,a,i={};for(a in R||u("swap","jQuery.swap() is undocumented and deprecated"),t)i[a]=e.style[a],e.style[a]=t[a];for(a in o=r.apply(e,n||[]),t)e.style[a]=i[a];return o},"swap"),e("3.4.0")&&"undefined"!=typeof Proxy&&(s.cssProps=new Proxy(s.cssProps||{},{set:function(){return u("cssProps","jQuery.cssProps is deprecated"),Reflect.set.apply(this,arguments)}})),e("4.0.0")?(A={animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},"undefined"!=typeof Proxy?s.cssNumber=new Proxy(A,{get:function(){return u("css-number","jQuery.cssNumber is deprecated"),Reflect.get.apply(this,arguments)},set:function(){return u("css-number","jQuery.cssNumber is deprecated"),Reflect.set.apply(this,arguments)}}):s.cssNumber=A):A=s.cssNumber,Q=s.fn.css,i(s.fn,"css",function(e,t){var r,n,o=this;return e&&"object"==typeof e&&!Array.isArray(e)?(s.each(e,function(e,t){s.fn.css.call(o,e,t)}),this):("number"==typeof t&&(r=x(e),n=r,C.test(n)&&N.test(n[0].toUpperCase()+n.slice(1))||A[r]||u("css-number",'Number-typed values are deprecated for jQuery.fn.css( "'+e+'", value )')),Q.apply(this,arguments))},"css-number");var S,P,k,H,E=s.data;i(s,"data",function(e,t,r){var n,o,a;if(t&&"object"==typeof t&&2===arguments.length){for(a in n=s.hasData(e)&&E.call(this,e),o={},t)a!==x(a)?(u("data-camelCase","jQuery.data() always sets/gets camelCased names: "+a),n[a]=t[a]):o[a]=t[a];return E.call(this,e,o),t}return t&&"string"==typeof t&&t!==x(t)&&(n=s.hasData(e)&&E.call(this,e))&&t in n?(u("data-camelCase","jQuery.data() always sets/gets camelCased names: "+t),2<arguments.length&&(n[t]=r),n[t]):E.apply(this,arguments)},"data-camelCase"),s.fx&&(k=s.Tween.prototype.run,H=function(e){return e},i(s.Tween.prototype,"run",function(){1<s.easing[this.easing].length&&(u("easing-one-arg","'jQuery.easing."+this.easing.toString()+"' should use only one argument"),s.easing[this.easing]=H),k.apply(this,arguments)},"easing-one-arg"),S=s.fx.interval,P="jQuery.fx.interval is deprecated",n.requestAnimationFrame&&Object.defineProperty(s.fx,"interval",{configurable:!0,enumerable:!0,get:function(){return n.document.hidden||u("fx-interval",P),s.migrateIsPatchEnabled("fx-interval")&&void 0===S?13:S},set:function(e){u("fx-interval",P),S=e}}));var M=s.fn.load,q=s.event.add,O=s.event.fix;s.event.props=[],s.event.fixHooks={},r(s.event.props,"concat",s.event.props.concat,"event-old-patch","jQuery.event.props.concat() is deprecated and removed"),i(s.event,"fix",function(e){var t,r=e.type,n=this.fixHooks[r],o=s.event.props;if(o.length){u("event-old-patch","jQuery.event.props are deprecated and removed: "+o.join());while(o.length)s.event.addProp(o.pop())}if(n&&!n._migrated_&&(n._migrated_=!0,u("event-old-patch","jQuery.event.fixHooks are deprecated and removed: "+r),(o=n.props)&&o.length))while(o.length)s.event.addProp(o.pop());return t=O.call(this,e),n&&n.filter?n.filter(t,e):t},"event-old-patch"),i(s.event,"add",function(e,t){return e===n&&"load"===t&&"complete"===n.document.readyState&&u("load-after-event","jQuery(window).on('load'...) called after load event occurred"),q.apply(this,arguments)},"load-after-event"),s.each(["load","unload","error"],function(e,t){i(s.fn,t,function(){var e=Array.prototype.slice.call(arguments,0);return"load"===t&&"string"==typeof e[0]?M.apply(this,e):(u("shorthand-removed-v3","jQuery.fn."+t+"() is deprecated"),e.splice(0,0,t),arguments.length?this.on.apply(this,e):(this.triggerHandler.apply(this,e),this))},"shorthand-removed-v3")}),s.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,r){c(s.fn,r,function(e,t){return 0<arguments.length?this.on(r,null,e,t):this.trigger(r)},"shorthand-deprecated-v3","jQuery.fn."+r+"() event shorthand is deprecated")}),s(function(){s(n.document).triggerHandler("ready")}),s.event.special.ready={setup:function(){this===n.document&&u("ready-event","'ready' event is deprecated")}},c(s.fn,"bind",function(e,t,r){return this.on(e,null,t,r)},"pre-on-methods","jQuery.fn.bind() is deprecated"),c(s.fn,"unbind",function(e,t){return this.off(e,null,t)},"pre-on-methods","jQuery.fn.unbind() is deprecated"),c(s.fn,"delegate",function(e,t,r,n){return this.on(t,e,r,n)},"pre-on-methods","jQuery.fn.delegate() is deprecated"),c(s.fn,"undelegate",function(e,t,r){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",r)},"pre-on-methods","jQuery.fn.undelegate() is deprecated"),c(s.fn,"hover",function(e,t){return this.on("mouseenter",e).on("mouseleave",t||e)},"pre-on-methods","jQuery.fn.hover() is deprecated");function T(e){var t=n.document.implementation.createHTMLDocument("");return t.body.innerHTML=e,t.body&&t.body.innerHTML}var F=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi;s.UNSAFE_restoreLegacyHtmlPrefilter=function(){s.migrateEnablePatches("self-closed-tags")},i(s,"htmlPrefilter",function(e){var t,r;return(r=(t=e).replace(F,"<$1></$2>"))!==t&&T(t)!==T(r)&&u("self-closed-tags","HTML tags must be properly nested and closed: "+t),e.replace(F,"<$1></$2>")},"self-closed-tags"),s.migrateDisablePatches("self-closed-tags");var D,W,_,I=s.fn.offset;return i(s.fn,"offset",function(){var e=this[0];return!e||e.nodeType&&e.getBoundingClientRect?I.apply(this,arguments):(u("offset-valid-elem","jQuery.fn.offset() requires a valid DOM element"),arguments.length?this:void 0)},"offset-valid-elem"),s.ajax&&(D=s.param,i(s,"param",function(e,t){var r=s.ajaxSettings&&s.ajaxSettings.traditional;return void 0===t&&r&&(u("param-ajax-traditional","jQuery.param() no longer uses jQuery.ajaxSettings.traditional"),t=r),D.call(this,e,t)},"param-ajax-traditional")),c(s.fn,"andSelf",s.fn.addBack,"andSelf","jQuery.fn.andSelf() is deprecated and removed, use jQuery.fn.addBack()"),s.Deferred&&(W=s.Deferred,_=[["resolve","done",s.Callbacks("once memory"),s.Callbacks("once memory"),"resolved"],["reject","fail",s.Callbacks("once memory"),s.Callbacks("once memory"),"rejected"],["notify","progress",s.Callbacks("memory"),s.Callbacks("memory")]],i(s,"Deferred",function(e){var a=W(),i=a.promise();function t(){var o=arguments;return s.Deferred(function(n){s.each(_,function(e,t){var r="function"==typeof o[e]&&o[e];a[t[1]](function(){var e=r&&r.apply(this,arguments);e&&"function"==typeof e.promise?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[t[0]+"With"](this===i?n.promise():this,r?[e]:arguments)})}),o=null}).promise()}return c(a,"pipe",t,"deferred-pipe","deferred.pipe() is deprecated"),c(i,"pipe",t,"deferred-pipe","deferred.pipe() is deprecated"),e&&e.call(a,a),a},"deferred-pipe"),s.Deferred.exceptionHook=W.exceptionHook),s});
/*
    jQuery Masked Input Plugin
    Copyright (c) 2007 - 2015 Josh Bush (digitalbush.com)
    Licensed under the MIT license (http://digitalbush.com/projects/masked-input-plugin/#license)
    Version: 1.4.1
*/
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){var b,c=navigator.userAgent,d=/iphone/i.test(c),e=/chrome/i.test(c),f=/android/i.test(c);a.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},autoclear:!0,dataName:"rawMaskFn",placeholder:"_"},a.fn.extend({caret:function(a,b){var c;if(0!==this.length&&!this.is(":hidden"))return"number"==typeof a?(b="number"==typeof b?b:a,this.each(function(){this.setSelectionRange?this.setSelectionRange(a,b):this.createTextRange&&(c=this.createTextRange(),c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",a),c.select())})):(this[0].setSelectionRange?(a=this[0].selectionStart,b=this[0].selectionEnd):document.selection&&document.selection.createRange&&(c=document.selection.createRange(),a=0-c.duplicate().moveStart("character",-1e5),b=a+c.text.length),{begin:a,end:b})},unmask:function(){return this.trigger("unmask")},mask:function(c,g){var h,i,j,k,l,m,n,o;if(!c&&this.length>0){h=a(this[0]);var p=h.data(a.mask.dataName);return p?p():void 0}return g=a.extend({autoclear:a.mask.autoclear,placeholder:a.mask.placeholder,completed:null},g),i=a.mask.definitions,j=[],k=n=c.length,l=null,a.each(c.split(""),function(a,b){"?"==b?(n--,k=a):i[b]?(j.push(new RegExp(i[b])),null===l&&(l=j.length-1),k>a&&(m=j.length-1)):j.push(null)}),this.trigger("unmask").each(function(){function h(){if(g.completed){for(var a=l;m>=a;a++)if(j[a]&&C[a]===p(a))return;g.completed.call(B)}}function p(a){return g.placeholder.charAt(a<g.placeholder.length?a:0)}function q(a){for(;++a<n&&!j[a];);return a}function r(a){for(;--a>=0&&!j[a];);return a}function s(a,b){var c,d;if(!(0>a)){for(c=a,d=q(b);n>c;c++)if(j[c]){if(!(n>d&&j[c].test(C[d])))break;C[c]=C[d],C[d]=p(d),d=q(d)}z(),B.caret(Math.max(l,a))}}function t(a){var b,c,d,e;for(b=a,c=p(a);n>b;b++)if(j[b]){if(d=q(b),e=C[b],C[b]=c,!(n>d&&j[d].test(e)))break;c=e}}function u(){var a=B.val(),b=B.caret();if(o&&o.length&&o.length>a.length){for(A(!0);b.begin>0&&!j[b.begin-1];)b.begin--;if(0===b.begin)for(;b.begin<l&&!j[b.begin];)b.begin++;B.caret(b.begin,b.begin)}else{for(A(!0);b.begin<n&&!j[b.begin];)b.begin++;B.caret(b.begin,b.begin)}h()}function v(){A(),B.val()!=E&&B.change()}function w(a){if(!B.prop("readonly")){var b,c,e,f=a.which||a.keyCode;o=B.val(),8===f||46===f||d&&127===f?(b=B.caret(),c=b.begin,e=b.end,e-c===0&&(c=46!==f?r(c):e=q(c-1),e=46===f?q(e):e),y(c,e),s(c,e-1),a.preventDefault()):13===f?v.call(this,a):27===f&&(B.val(E),B.caret(0,A()),a.preventDefault())}}function x(b){if(!B.prop("readonly")){var c,d,e,g=b.which||b.keyCode,i=B.caret();if(!(b.ctrlKey||b.altKey||b.metaKey||32>g)&&g&&13!==g){if(i.end-i.begin!==0&&(y(i.begin,i.end),s(i.begin,i.end-1)),c=q(i.begin-1),n>c&&(d=String.fromCharCode(g),j[c].test(d))){if(t(c),C[c]=d,z(),e=q(c),f){var k=function(){a.proxy(a.fn.caret,B,e)()};setTimeout(k,0)}else B.caret(e);i.begin<=m&&h()}b.preventDefault()}}}function y(a,b){var c;for(c=a;b>c&&n>c;c++)j[c]&&(C[c]=p(c))}function z(){B.val(C.join(""))}function A(a){var b,c,d,e=B.val(),f=-1;for(b=0,d=0;n>b;b++)if(j[b]){for(C[b]=p(b);d++<e.length;)if(c=e.charAt(d-1),j[b].test(c)){C[b]=c,f=b;break}if(d>e.length){y(b+1,n);break}}else C[b]===e.charAt(d)&&d++,k>b&&(f=b);return a?z():k>f+1?g.autoclear||C.join("")===D?(B.val()&&B.val(""),y(0,n)):z():(z(),B.val(B.val().substring(0,f+1))),k?b:l}var B=a(this),C=a.map(c.split(""),function(a,b){return"?"!=a?i[a]?p(b):a:void 0}),D=C.join(""),E=B.val();B.data(a.mask.dataName,function(){return a.map(C,function(a,b){return j[b]&&a!=p(b)?a:null}).join("")}),B.one("unmask",function(){B.off(".mask").removeData(a.mask.dataName)}).on("focus.mask",function(){if(!B.prop("readonly")){clearTimeout(b);var a;E=B.val(),a=A(),b=setTimeout(function(){B.get(0)===document.activeElement&&(z(),a==c.replace("?","").length?B.caret(0,a):B.caret(a))},10)}}).on("blur.mask",v).on("keydown.mask",w).on("keypress.mask",x).on("input.mask paste.mask",function(){B.prop("readonly")||setTimeout(function(){var a=A(!0);B.caret(a),h()},0)}),e&&f&&B.off("input.mask").on("input.mask",u),A()})}})});
/*! Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 * 
 * Requires: 1.2.2+
 */

(function($) {

var types = ['DOMMouseScroll', 'mousewheel'];

if ($.event.fixHooks) {
    for ( var i=types.length; i; ) {
        $.event.fixHooks[ types[--i] ] = $.event.mouseHooks;
    }
}

$.event.special.mousewheel = {
    setup: function() {
        if ( this.addEventListener ) {
            for ( var i=types.length; i; ) {
                this.addEventListener( types[--i], handler, false );
            }
        } else {
            this.onmousewheel = handler;
        }
    },
    
    teardown: function() {
        if ( this.removeEventListener ) {
            for ( var i=types.length; i; ) {
                this.removeEventListener( types[--i], handler, false );
            }
        } else {
            this.onmousewheel = null;
        }
    }
};

$.fn.extend({
    mousewheel: function(fn) {
        return fn ? this.bind("mousewheel", fn) : this.trigger("mousewheel");
    },
    
    unmousewheel: function(fn) {
        return this.unbind("mousewheel", fn);
    }
});


function handler(event) {
    var orgEvent = event || window.event, args = [].slice.call( arguments, 1 ), delta = 0, returnValue = true, deltaX = 0, deltaY = 0;
    event = $.event.fix(orgEvent);
    event.type = "mousewheel";
    
    // Old school scrollwheel delta
    if ( orgEvent.wheelDelta ) { delta = orgEvent.wheelDelta/120; }
    if ( orgEvent.detail     ) { delta = -orgEvent.detail/3; }
    
    // New school multidimensional scroll (touchpads) deltas
    deltaY = delta;
    
    // Gecko
    if ( orgEvent.axis !== undefined && orgEvent.axis === orgEvent.HORIZONTAL_AXIS ) {
        deltaY = 0;
        deltaX = -1*delta;
    }
    
    // Webkit
    if ( orgEvent.wheelDeltaY !== undefined ) { deltaY = orgEvent.wheelDeltaY/120; }
    if ( orgEvent.wheelDeltaX !== undefined ) { deltaX = -1*orgEvent.wheelDeltaX/120; }
    
    // Add event and delta to the front of the arguments
    args.unshift(event, delta, deltaX, deltaY);
    
    return ($.event.dispatch || $.event.handle).apply(this, args);
}

})(jQuery);
// Magnific Popup v1.1.0 by Dmitry Semenov
// http://bit.ly/magnific-popup#build=inline+ajax
(function(a){typeof define=="function"&&define.amd?define(["jquery"],a):typeof exports=="object"?a(require("jquery")):a(window.jQuery||window.Zepto)})(function(a){var b="Close",c="BeforeClose",d="AfterClose",e="BeforeAppend",f="MarkupParse",g="Open",h="Change",i="mfp",j="."+i,k="mfp-ready",l="mfp-removing",m="mfp-prevent-close",n,o=function(){},p=!!window.jQuery,q,r=a(window),s,t,u,v,w=function(a,b){n.ev.on(i+a+j,b)},x=function(b,c,d,e){var f=document.createElement("div");return f.className="mfp-"+b,d&&(f.innerHTML=d),e?c&&c.appendChild(f):(f=a(f),c&&f.appendTo(c)),f},y=function(b,c){n.ev.triggerHandler(i+b,c),n.st.callbacks&&(b=b.charAt(0).toLowerCase()+b.slice(1),n.st.callbacks[b]&&n.st.callbacks[b].apply(n,a.isArray(c)?c:[c]))},z=function(b){if(b!==v||!n.currTemplate.closeBtn)n.currTemplate.closeBtn=a(n.st.closeMarkup.replace("%title%",n.st.tClose)),v=b;return n.currTemplate.closeBtn},A=function(){a.magnificPopup.instance||(n=new o,n.init(),a.magnificPopup.instance=n)},B=function(){var a=document.createElement("p").style,b=["ms","O","Moz","Webkit"];if(a.transition!==undefined)return!0;while(b.length)if(b.pop()+"Transition"in a)return!0;return!1};o.prototype={constructor:o,init:function(){var b=navigator.appVersion;n.isLowIE=n.isIE8=document.all&&!document.addEventListener,n.isAndroid=/android/gi.test(b),n.isIOS=/iphone|ipad|ipod/gi.test(b),n.supportsTransition=B(),n.probablyMobile=n.isAndroid||n.isIOS||/(Opera Mini)|Kindle|webOS|BlackBerry|(Opera Mobi)|(Windows Phone)|IEMobile/i.test(navigator.userAgent),s=a(document),n.popupsCache={}},open:function(b){var c;if(b.isObj===!1){n.items=b.items.toArray(),n.index=0;var d=b.items,e;for(c=0;c<d.length;c++){e=d[c],e.parsed&&(e=e.el[0]);if(e===b.el[0]){n.index=c;break}}}else n.items=a.isArray(b.items)?b.items:[b.items],n.index=b.index||0;if(n.isOpen){n.updateItemHTML();return}n.types=[],u="",b.mainEl&&b.mainEl.length?n.ev=b.mainEl.eq(0):n.ev=s,b.key?(n.popupsCache[b.key]||(n.popupsCache[b.key]={}),n.currTemplate=n.popupsCache[b.key]):n.currTemplate={},n.st=a.extend(!0,{},a.magnificPopup.defaults,b),n.fixedContentPos=n.st.fixedContentPos==="auto"?!n.probablyMobile:n.st.fixedContentPos,n.st.modal&&(n.st.closeOnContentClick=!1,n.st.closeOnBgClick=!1,n.st.showCloseBtn=!1,n.st.enableEscapeKey=!1),n.bgOverlay||(n.bgOverlay=x("bg").on("click"+j,function(){n.close()}),n.wrap=x("wrap").attr("tabindex",-1).on("click"+j,function(a){n._checkIfClose(a.target)&&n.close()}),n.container=x("container",n.wrap)),n.contentContainer=x("content"),n.st.preloader&&(n.preloader=x("preloader",n.container,n.st.tLoading));var h=a.magnificPopup.modules;for(c=0;c<h.length;c++){var i=h[c];i=i.charAt(0).toUpperCase()+i.slice(1),n["init"+i].call(n)}y("BeforeOpen"),n.st.showCloseBtn&&(n.st.closeBtnInside?(w(f,function(a,b,c,d){c.close_replaceWith=z(d.type)}),u+=" mfp-close-btn-in"):n.wrap.append(z())),n.st.alignTop&&(u+=" mfp-align-top"),n.fixedContentPos?n.wrap.css({overflow:n.st.overflowY,overflowX:"hidden",overflowY:n.st.overflowY}):n.wrap.css({top:r.scrollTop(),position:"absolute"}),(n.st.fixedBgPos===!1||n.st.fixedBgPos==="auto"&&!n.fixedContentPos)&&n.bgOverlay.css({height:s.height(),position:"absolute"}),n.st.enableEscapeKey&&s.on("keyup"+j,function(a){a.keyCode===27&&n.close()}),r.on("resize"+j,function(){n.updateSize()}),n.st.closeOnContentClick||(u+=" mfp-auto-cursor"),u&&n.wrap.addClass(u);var l=n.wH=r.height(),m={};if(n.fixedContentPos&&n._hasScrollBar(l)){var o=n._getScrollbarSize();o&&(m.marginRight=o)}n.fixedContentPos&&(n.isIE7?a("body, html").css("overflow","hidden"):m.overflow="hidden");var p=n.st.mainClass;return n.isIE7&&(p+=" mfp-ie7"),p&&n._addClassToMFP(p),n.updateItemHTML(),y("BuildControls"),a("html").css(m),n.bgOverlay.add(n.wrap).prependTo(n.st.prependTo||a(document.body)),n._lastFocusedEl=document.activeElement,setTimeout(function(){n.content?(n._addClassToMFP(k),n._setFocus()):n.bgOverlay.addClass(k),s.on("focusin"+j,n._onFocusIn)},16),n.isOpen=!0,n.updateSize(l),y(g),b},close:function(){if(!n.isOpen)return;y(c),n.isOpen=!1,n.st.removalDelay&&!n.isLowIE&&n.supportsTransition?(n._addClassToMFP(l),setTimeout(function(){n._close()},n.st.removalDelay)):n._close()},_close:function(){y(b);var c=l+" "+k+" ";n.bgOverlay.detach(),n.wrap.detach(),n.container.empty(),n.st.mainClass&&(c+=n.st.mainClass+" "),n._removeClassFromMFP(c);if(n.fixedContentPos){var e={marginRight:""};n.isIE7?a("body, html").css("overflow",""):e.overflow="",a("html").css(e)}s.off("keyup"+j+" focusin"+j),n.ev.off(j),n.wrap.attr("class","mfp-wrap").removeAttr("style"),n.bgOverlay.attr("class","mfp-bg"),n.container.attr("class","mfp-container"),n.st.showCloseBtn&&(!n.st.closeBtnInside||n.currTemplate[n.currItem.type]===!0)&&n.currTemplate.closeBtn&&n.currTemplate.closeBtn.detach(),n.st.autoFocusLast&&n._lastFocusedEl&&a(n._lastFocusedEl).focus(),n.currItem=null,n.content=null,n.currTemplate=null,n.prevHeight=0,y(d)},updateSize:function(a){if(n.isIOS){var b=document.documentElement.clientWidth/window.innerWidth,c=window.innerHeight*b;n.wrap.css("height",c),n.wH=c}else n.wH=a||r.height();n.fixedContentPos||n.wrap.css("height",n.wH),y("Resize")},updateItemHTML:function(){var b=n.items[n.index];n.contentContainer.detach(),n.content&&n.content.detach(),b.parsed||(b=n.parseEl(n.index));var c=b.type;y("BeforeChange",[n.currItem?n.currItem.type:"",c]),n.currItem=b;if(!n.currTemplate[c]){var d=n.st[c]?n.st[c].markup:!1;y("FirstMarkupParse",d),d?n.currTemplate[c]=a(d):n.currTemplate[c]=!0}t&&t!==b.type&&n.container.removeClass("mfp-"+t+"-holder");var e=n["get"+c.charAt(0).toUpperCase()+c.slice(1)](b,n.currTemplate[c]);n.appendContent(e,c),b.preloaded=!0,y(h,b),t=b.type,n.container.prepend(n.contentContainer),y("AfterChange")},appendContent:function(a,b){n.content=a,a?n.st.showCloseBtn&&n.st.closeBtnInside&&n.currTemplate[b]===!0?n.content.find(".mfp-close").length||n.content.append(z()):n.content=a:n.content="",y(e),n.container.addClass("mfp-"+b+"-holder"),n.contentContainer.append(n.content)},parseEl:function(b){var c=n.items[b],d;c.tagName?c={el:a(c)}:(d=c.type,c={data:c,src:c.src});if(c.el){var e=n.types;for(var f=0;f<e.length;f++)if(c.el.hasClass("mfp-"+e[f])){d=e[f];break}c.src=c.el.attr("data-mfp-src"),c.src||(c.src=c.el.attr("href"))}return c.type=d||n.st.type||"inline",c.index=b,c.parsed=!0,n.items[b]=c,y("ElementParse",c),n.items[b]},addGroup:function(a,b){var c=function(c){c.mfpEl=this,n._openClick(c,a,b)};b||(b={});var d="click.magnificPopup";b.mainEl=a,b.items?(b.isObj=!0,a.off(d).on(d,c)):(b.isObj=!1,b.delegate?a.off(d).on(d,b.delegate,c):(b.items=a,a.off(d).on(d,c)))},_openClick:function(b,c,d){var e=d.midClick!==undefined?d.midClick:a.magnificPopup.defaults.midClick;if(!e&&(b.which===2||b.ctrlKey||b.metaKey||b.altKey||b.shiftKey))return;var f=d.disableOn!==undefined?d.disableOn:a.magnificPopup.defaults.disableOn;if(f)if(a.isFunction(f)){if(!f.call(n))return!0}else if(r.width()<f)return!0;b.type&&(b.preventDefault(),n.isOpen&&b.stopPropagation()),d.el=a(b.mfpEl),d.delegate&&(d.items=c.find(d.delegate)),n.open(d)},updateStatus:function(a,b){if(n.preloader){q!==a&&n.container.removeClass("mfp-s-"+q),!b&&a==="loading"&&(b=n.st.tLoading);var c={status:a,text:b};y("UpdateStatus",c),a=c.status,b=c.text,n.preloader.html(b),n.preloader.find("a").on("click",function(a){a.stopImmediatePropagation()}),n.container.addClass("mfp-s-"+a),q=a}},_checkIfClose:function(b){if(a(b).hasClass(m))return;var c=n.st.closeOnContentClick,d=n.st.closeOnBgClick;if(c&&d)return!0;if(!n.content||a(b).hasClass("mfp-close")||n.preloader&&b===n.preloader[0])return!0;if(b!==n.content[0]&&!a.contains(n.content[0],b)){if(d&&a.contains(document,b))return!0}else if(c)return!0;return!1},_addClassToMFP:function(a){n.bgOverlay.addClass(a),n.wrap.addClass(a)},_removeClassFromMFP:function(a){this.bgOverlay.removeClass(a),n.wrap.removeClass(a)},_hasScrollBar:function(a){return(n.isIE7?s.height():document.body.scrollHeight)>(a||r.height())},_setFocus:function(){(n.st.focus?n.content.find(n.st.focus).eq(0):n.wrap).focus()},_onFocusIn:function(b){if(b.target!==n.wrap[0]&&!a.contains(n.wrap[0],b.target))return n._setFocus(),!1},_parseMarkup:function(b,c,d){var e;d.data&&(c=a.extend(d.data,c)),y(f,[b,c,d]),a.each(c,function(c,d){if(d===undefined||d===!1)return!0;e=c.split("_");if(e.length>1){var f=b.find(j+"-"+e[0]);if(f.length>0){var g=e[1];g==="replaceWith"?f[0]!==d[0]&&f.replaceWith(d):g==="img"?f.is("img")?f.attr("src",d):f.replaceWith(a("<img>").attr("src",d).attr("class",f.attr("class"))):f.attr(e[1],d)}}else b.find(j+"-"+c).html(d)})},_getScrollbarSize:function(){if(n.scrollbarSize===undefined){var a=document.createElement("div");a.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;",document.body.appendChild(a),n.scrollbarSize=a.offsetWidth-a.clientWidth,document.body.removeChild(a)}return n.scrollbarSize}},a.magnificPopup={instance:null,proto:o.prototype,modules:[],open:function(b,c){return A(),b?b=a.extend(!0,{},b):b={},b.isObj=!0,b.index=c||0,this.instance.open(b)},close:function(){return a.magnificPopup.instance&&a.magnificPopup.instance.close()},registerModule:function(b,c){c.options&&(a.magnificPopup.defaults[b]=c.options),a.extend(this.proto,c.proto),this.modules.push(b)},defaults:{disableOn:0,key:null,midClick:!1,mainClass:"",preloader:!0,focus:"",closeOnContentClick:!1,closeOnBgClick:!0,closeBtnInside:!0,showCloseBtn:!0,enableEscapeKey:!0,modal:!1,alignTop:!1,removalDelay:0,prependTo:null,fixedContentPos:"auto",fixedBgPos:"auto",overflowY:"auto",closeMarkup:'<button title="%title%" type="button" class="mfp-close"></button>',tClose:"Close (Esc)",tLoading:"Loading...",autoFocusLast:!0}},a.fn.magnificPopup=function(b){A();var c=a(this);if(typeof b=="string")if(b==="open"){var d,e=p?c.data("magnificPopup"):c[0].magnificPopup,f=parseInt(arguments[1],10)||0;e.items?d=e.items[f]:(d=c,e.delegate&&(d=d.find(e.delegate)),d=d.eq(f)),n._openClick({mfpEl:d},c,e)}else n.isOpen&&n[b].apply(n,Array.prototype.slice.call(arguments,1));else b=a.extend(!0,{},b),p?c.data("magnificPopup",b):c[0].magnificPopup=b,n.addGroup(c,b);return c};var C="inline",D,E,F,G=function(){F&&(E.after(F.addClass(D)).detach(),F=null)};a.magnificPopup.registerModule(C,{options:{hiddenClass:"hide",markup:"",tNotFound:"Content not found"},proto:{initInline:function(){n.types.push(C),w(b+"."+C,function(){G()})},getInline:function(b,c){G();if(b.src){var d=n.st.inline,e=a(b.src);if(e.length){var f=e[0].parentNode;f&&f.tagName&&(E||(D=d.hiddenClass,E=x(D),D="mfp-"+D),F=e.after(E).detach().removeClass(D)),n.updateStatus("ready")}else n.updateStatus("error",d.tNotFound),e=a("<div>");return b.inlineElement=e,e}return n.updateStatus("ready"),n._parseMarkup(c,{},b),c}}});var H="ajax",I,J=function(){I&&a(document.body).removeClass(I)},K=function(){J(),n.req&&n.req.abort()};a.magnificPopup.registerModule(H,{options:{settings:null,cursor:"mfp-ajax-cur",tError:'<a href="%url%">The content</a> could not be loaded.'},proto:{initAjax:function(){n.types.push(H),I=n.st.ajax.cursor,w(b+"."+H,K),w("BeforeChange."+H,K)},getAjax:function(b){I&&a(document.body).addClass(I),n.updateStatus("loading");var c=a.extend({url:b.src,success:function(c,d,e){var f={data:c,xhr:e};y("ParseAjax",f),n.appendContent(a(f.data),H),b.finished=!0,J(),n._setFocus(),setTimeout(function(){n.wrap.addClass(k)},16),n.updateStatus("ready"),y("AjaxContentAdded")},error:function(){J(),b.finished=b.loadError=!0,n.updateStatus("error",n.st.ajax.tError.replace("%url%",b.src))}},n.st.ajax.settings);return n.req=a.ajax(c),""}}});var L,M=function(){return L===undefined&&(L=document.createElement("p").style.MozTransform!==undefined),L};a.magnificPopup.registerModule("zoom",{options:{enabled:!1,easing:"ease-in-out",duration:300,opener:function(a){return a.is("img")?a:a.find("img")}},proto:{initZoom:function(){var a=n.st.zoom,d=".zoom",e;if(!a.enabled||!n.supportsTransition)return;var f=a.duration,g=function(b){var c=b.clone().removeAttr("style").removeAttr("class").addClass("mfp-animated-image"),d="all "+a.duration/1e3+"s "+a.easing,e={position:"fixed",zIndex:9999,left:0,top:0,"-webkit-backface-visibility":"hidden"},f="transition";return e["-webkit-"+f]=e["-moz-"+f]=e["-o-"+f]=e[f]=d,c.css(e),c},h=function(){n.content.css("visibility","visible")},i,j;w("BuildControls"+d,function(){if(n._allowZoom()){clearTimeout(i),n.content.css("visibility","hidden"),e=n._getItemToZoom();if(!e){h();return}j=g(e),j.css(n._getOffset()),n.wrap.append(j),i=setTimeout(function(){j.css(n._getOffset(!0)),i=setTimeout(function(){h(),setTimeout(function(){j.remove(),e=j=null,y("ZoomAnimationEnded")},16)},f)},16)}}),w(c+d,function(){if(n._allowZoom()){clearTimeout(i),n.st.removalDelay=f;if(!e){e=n._getItemToZoom();if(!e)return;j=g(e)}j.css(n._getOffset(!0)),n.wrap.append(j),n.content.css("visibility","hidden"),setTimeout(function(){j.css(n._getOffset())},16)}}),w(b+d,function(){n._allowZoom()&&(h(),j&&j.remove(),e=null)})},_allowZoom:function(){return n.currItem.type==="image"},_getItemToZoom:function(){return n.currItem.hasSize?n.currItem.img:!1},_getOffset:function(b){var c;b?c=n.currItem.img:c=n.st.zoom.opener(n.currItem.el||n.currItem);var d=c.offset(),e=parseInt(c.css("padding-top"),10),f=parseInt(c.css("padding-bottom"),10);d.top-=a(window).scrollTop()-e;var g={width:c.width(),height:(p?c.innerHeight():c[0].offsetHeight)-f-e};return M()?g["-moz-transform"]=g.transform="translate("+d.left+"px,"+d.top+"px)":(g.left=d.left,g.top=d.top),g}}}),A()})
/*
// jQuery multiSelect
//
// Version 1.2.2 beta
//
// Cory S.N. LaViska
// A Beautiful Site (http://abeautifulsite.net/)
// 09 September 2009
//
// Visit http://abeautifulsite.net/notebook/62 for more information
//
// (Amended by Andy Richmond, Letters & Science Deans' Office, University of California, Davis)
//
// Usage: $('#control_id').multiSelect( options, callback )
//
// Options:  selectAll          - whether or not to display the Select All option; true/false, default = true
//           selectAllText      - text to display for selecting/unselecting all options simultaneously
//           noneSelected       - text to display when there are no selected items in the list
//           oneOrMoreSelected  - text to display when there are one or more selected items in the list
//                                (note: you can use % as a placeholder for the number of items selected).
//                                Use * to show a comma separated list of all selected; default = '% selected'
//           optGroupSelectable - whether or not optgroups are selectable if you use them; true/false, default = false
//           listHeight         - the max height of the droptdown options
//
// Dependencies:  jQuery 1.2.6 or higher (http://jquery.com/)
//
// Change Log:
//
//		1.0.1	- Updated to work with jQuery 1.2.6+ (no longer requires the dimensions plugin)
//				- Changed $(this).offset() to $(this).position(), per James' and Jono's suggestions
//
//		1.0.2	- Fixed issue where dropdown doesn't scroll up/down with keyboard shortcuts
//				- Changed '$' in setTimeout to use 'jQuery' to support jQuery.noConflict
//				- Renamed from jqueryMultiSelect.* to jquery.multiSelect.* per the standard recommended at
//				  http://docs.jquery.com/Plugins/Authoring (does not affect API methods)
//
//		1.0.3	- Now uses the bgiframe plugin (if it exists) to fix the IE6 layering bug.
//              - Forces IE6 to use a min-height of 200px (this needs to be added to the options)
//
//		1.1.0	- Added the ability to update the options dynamically via javascript: multiSelectOptionsUpdate(JSON)
//              - Added a title that displays the whole comma delimited list when using oneOrMoreSelected = *
//              - Moved some of the functions to be closured to make them private
//              - Changed the way the keyboard navigation worked to more closely match how a standard dropdown works
//              - ** by Andy Richmond **
//
//		1.2.0	- Added support for optgroups
//              - Added the ability for selectable optgroups (i.e. select all for an optgroup)
//              - ** by Andy Richmond **
//
//		1.2.1	- Fixed bug where input text overlapped dropdown arrow in IE (i.e. when using oneOrMoreSelected = *)
//              - Added option "listHeight" for min-height of the dropdown
//              - Fixed bug where bgiframe was causing a horizontal scrollbar and on short lists extra whitespace below the options
//              - ** by Andy Richmond **
//
//		1.2.2	- Fixed bug where the keypress stopped showing the dropdown because in jQuery 1.3.2 they changed the way ':visible' works
//              - Fixed some other bugs in the way the keyboard interface worked
//              - Changed the main textbox to an <a> tag (with 'display: inline-block') to prevent the display text from being selected/highlighted
//              - Added the ability to jump to an option by typing the first character of that option (simular to a normal drop down)
//              - ** by Andy Richmond **
//				- Added [] to make each control submit an HTML array so $.serialize() works properly
//
// Licensing & Terms of Use
// 
// This plugin is dual-licensed under the GNU General Public License and the MIT License and
// is copyright 2008 A Beautiful Site, LLC. 
//	

	Catalin - Added W3C standards
*/
if(jQuery) (function($){
	
	// render the html for a single option
	function renderOption(id, option)
	{
		var html = '<label role="option"><input class="multipleOpt" type="checkbox" name="' + id + '[]" value="' + option.value + '"';
		if( option.selected ){
			html += ' checked="checked"';
		}
		html += ' />' + option.text + '</label>';
		
		return html;
	}
	
	// render the html for the options/optgroups
	function renderOptions(id, options, o)
	{
		var html = "";
		
		for(var i = 0; i < options.length; i++) {
			if(options[i].optgroup) {
				html += '<label class="optGroup">';
				
				if(o.optGroupSelectable) {
					html += '<input type="checkbox" class="optGroup" />' + options[i].optgroup;
				}
				else {
					html += options[i].optgroup;
				}
				
				html += '</label><div class="optGroupContainer">';
				
				html += renderOptions(id, options[i].options, o);
				
				html += '</div>';
			}
			else {
				html += renderOption(id, options[i]);
			}
		}
		
		return html;
	}
	
	// Building the actual options
	function buildOptions(options)
	{
		var multiSelect = $(this);
		var multiSelectOptions = multiSelect.next('.multiSelectOptions');
		var o = multiSelect.data("config");
		var callback = multiSelect.data("callback");

		// clear the existing options
		multiSelectOptions.html("");
		var html = "";

		// if we should have a select all option then add it
		if( o.selectAll ) {
			html += '<label class="selectAll"><input type="checkbox" class="selectAll multipleOpt" />' + o.selectAllText + '</label>';
		}

		// generate the html for the new options
		html += renderOptions(multiSelect.attr('id'), options, o);
		
		multiSelectOptions.html(html);
		
		// variables needed to account for width changes due to a scrollbar
		var initialWidth = multiSelectOptions.width();
		var hasScrollbar = false;
		
		// set the height of the dropdown options
		if(multiSelectOptions.height() > o.listHeight) {
			multiSelectOptions.css("height", o.listHeight + 'px');
			hasScrollbar = true;
		} else {
			multiSelectOptions.css("height", '');
		}
		
		// if the there is a scrollbar and the browser did not already handle adjusting the width (i.e. Firefox) then we will need to manaually add the scrollbar width
		var scrollbarWidth = hasScrollbar && (initialWidth == multiSelectOptions.width()) ? 17 : 0;

		// set the width of the dropdown options
		 if((multiSelectOptions.actual("width") + scrollbarWidth) < multiSelect.actual("outerWidth")) {
	        multiSelectOptions.css("width", multiSelect.actual("outerWidth") - 2/*border*/ + 'px');
        } else {
            multiSelectOptions.css("width", (multiSelectOptions.actual("width") + scrollbarWidth) + 'px');
        }
		
		// Apply bgiframe if available on IE6
		if( $.fn.bgiframe ) multiSelect.next('.multiSelectOptions').bgiframe( { width: multiSelectOptions.width(), height: multiSelectOptions.height() });

		// Handle selectAll oncheck
		if(o.selectAll) {
			multiSelectOptions.find('INPUT.selectAll').click( function() {
				var isChecked = $(this).is(':checked');
				multiSelectOptions.find('INPUT:checkbox').prop('checked', isChecked)
					.parent("LABEL").toggleClass('checked', isChecked);
			});
		}
		
		// Handle OptGroup oncheck
		if(o.optGroupSelectable) {
			multiSelectOptions.addClass('optGroupHasCheckboxes');
		
			multiSelectOptions.find('INPUT.optGroup').click( function() {
				// update all the child checkboxes
				var isChecked = $(this).is(':checked');
				$(this).parent().next().find('INPUT:checkbox').prop('checked', isChecked).parent("LABEL")
																	.toggleClass('checked', isChecked);
			});
		}
		
		// Handle all checkboxes
		multiSelectOptions.find('INPUT:checkbox').click( function() {
			// set the label checked class
			$(this).parent("LABEL").toggleClass('checked', $(this).is(':checked'));
			
			updateSelected.call(multiSelect);
			//multiSelect.focus();
			if($(this).parent().parent().hasClass('optGroupContainer')) {
				updateOptGroup.call(multiSelect, $(this).parent().parent().prev());
			}
			if( callback ) {
				callback($(this));
			}
		});
		
		// Initial display
		multiSelectOptions.each( function() {
			$(this).find('INPUT:checked').parent().addClass('checked');
		});
		
		// Initialize selected and select all 
		updateSelected.call(multiSelect);
		
		// Initialize optgroups
		if(o.optGroupSelectable) {
			multiSelectOptions.find('LABEL.optGroup').each( function() {
				updateOptGroup.call(multiSelect, $(this));
			});
		}
		
		// Handle hovers
		multiSelectOptions.find('LABEL:has(INPUT)').hover( function() {
			$(this).parent().find('LABEL').removeClass('hover');
			$(this).addClass('hover');
		}, function() {
			$(this).parent().find('LABEL').removeClass('hover');
		});
		
		// Keyboard
		
		multiSelectOptions.find("label").keydown(function(e){
			
			if(e.keyCode == 40){
				if($(this).next().exists())
					$(this).removeClass('hover').next().addClass('hover').focus();
				
				return true;
			}
			
			if(e.keyCode == 38){
				if($(this).prev().exists())
					$(this).removeClass('hover').prev().addClass('hover').focus();					
			}
			
			if( e.keyCode == 9 ) {
				var $multiSelectField = $(this).parent().prev();				
				$multiSelectField.addClass('focus').trigger('click'); // esc, left, right - hide
				$multiSelectField.next(':input').focus();
				
				return true;
			}
			
			// ESC, Left, Right
			if( e.keyCode == 27 || e.keyCode == 37 || e.keyCode == 39 ) {
				// Hide dropdown
				var $multiSelectField = $(this).parent().prev();
				$multiSelectField.addClass('focus').focus().trigger('click');
			}
			
			if(e.keyCode == 13){
				
				var $checkbox = $(this).find("input");
				var isChecked = $checkbox.prop("checked");
				$checkbox.prop("checked", !isChecked);
				$(this).toggleClass('checked', isChecked);
				
				updateSelected.call($(this).parent().prev());
				return false;
			}
			
		});
		
		multiSelect.keydown( function(e) {
		
			var multiSelectOptions = $(this).next('.multiSelectOptions');

			// Is dropdown visible?
			if( multiSelectOptions.css('visibility') != 'hidden' ) {
				// Dropdown is visible
				// Tab
				if( e.keyCode == 9 ) {
					$(this).addClass('focus').trigger('click'); // esc, left, right - hide
					$(this).focus().next(':input').focus();
					return true;
				}
				
				// ESC, Left, Right
				if( e.keyCode == 27 || e.keyCode == 37 || e.keyCode == 39 ) {
					// Hide dropdown
					$(this).addClass('focus').trigger('click');
				}
				// Down || Up
				if( e.keyCode == 40 || e.keyCode == 38) {
					var allOptions = multiSelectOptions.find('LABEL');
					var oldHoverIndex = allOptions.index(allOptions.filter('.hover'));
					var newHoverIndex = -1;
					
					// if there is no current highlighted item then highlight the first item
					if(oldHoverIndex < 0) {
						// Default to first item
						multiSelectOptions.find('LABEL:first').addClass('hover').focus();
					}
					// else if we are moving down and there is a next item then move
					else if(e.keyCode == 40 && oldHoverIndex < allOptions.length - 1)
					{
						newHoverIndex = oldHoverIndex + 1;
					}
					// else if we are moving up and there is a prev item then move
					else if(e.keyCode == 38 && oldHoverIndex > 0)
					{
						newHoverIndex = oldHoverIndex - 1;
					}

					if(newHoverIndex >= 0) {
						$(allOptions.get(oldHoverIndex)).removeClass('hover'); // remove the current highlight
						$(allOptions.get(newHoverIndex)).addClass('hover').focus(); // add the new highlight
						
						// Adjust the viewport if necessary
						adjustViewPort(multiSelectOptions);
					}
					
					return false;
				}

				// Enter, Space
				if( e.keyCode == 13 || e.keyCode == 32 ) {
					var selectedCheckbox = multiSelectOptions.find('LABEL.hover INPUT:checkbox');
					
					// Set the checkbox (and label class)
					var isChecked = selectedCheckbox.attr('checked');
					selectedCheckbox.prop('checked', !isChecked).parent("LABEL").toggleClass('checked', isChecked);
					
					// if the checkbox was the select all then set all the checkboxes
					if(selectedCheckbox.hasClass("selectAll")) {
						multiSelectOptions.find('INPUT:checkbox').prop('checked', isChecked).parent("LABEL").toggleClass('checked', isChecked);
					}

					updateSelected.call(multiSelect);
					
					if( callback ) callback($(this));
					return false;
				}

				// Any other standard keyboard character (try and match the first character of an option)
				if( e.keyCode >= 33 && e.keyCode <= 126 ) {
					// find the next matching item after the current hovered item
					var match = multiSelectOptions.find('LABEL:startsWith(' + String.fromCharCode(e.keyCode) + ')');
					
					var currentHoverIndex = match.index(match.filter('LABEL.hover'));
					
					// filter the set to any items after the current hovered item
					var afterHoverMatch = match.filter(function (index) {
						return index > currentHoverIndex;
					});

					// if there were no item after the current hovered item then try using the full search results (filtered to the first one)
					match = (afterHoverMatch.length >= 1 ? afterHoverMatch : match).filter("LABEL:first");

					if(match.length == 1) {
						// if we found a match then move the hover
						multiSelectOptions.find('LABEL.hover').removeClass('hover');								
						match.addClass('hover');
						
						adjustViewPort(multiSelectOptions);
					}
				}
			} else {
				// Dropdown is not visible
				if( e.keyCode == 38 || e.keyCode == 40 || e.keyCode == 13 || e.keyCode == 32 ) { //up, down, enter, space - show
					// Show dropdown
					$(this).removeClass('focus').trigger('click');
					multiSelectOptions.attr("aria-hidden", "false");
					multiSelectOptions.find('LABEL:first').addClass('hover').focus();
					return false;
				}
				//  Tab key
				if( e.keyCode == 9 ) {
					// Shift focus to next INPUT element on page
					multiSelectOptions.next(':input').focus();
					return true;
				}
			}
			// Prevent enter key from submitting form
			if( e.keyCode == 13 ) return false;
		});
	}
	
	// Adjust the viewport if necessary
	function adjustViewPort(multiSelectOptions)
	{
		// check for and move down
		var selectionBottom = multiSelectOptions.find('LABEL.hover').position().top + multiSelectOptions.find('LABEL.hover').outerHeight();
		
		if(selectionBottom > multiSelectOptions.innerHeight()){		
			multiSelectOptions.scrollTop(multiSelectOptions.scrollTop() + selectionBottom - multiSelectOptions.innerHeight());
		}
		
		// check for and move up						
		if(multiSelectOptions.find('LABEL.hover').position().top < 0){		
			multiSelectOptions.scrollTop(multiSelectOptions.scrollTop() + multiSelectOptions.find('LABEL.hover').position().top);
		}
	}
	
	// Update the optgroup checked status
	function updateOptGroup(optGroup)
	{
		var multiSelect = $(this);
		var o = multiSelect.data("config");
		
		// Determine if the optgroup should be checked
		if(o.optGroupSelectable) {
			var optGroupSelected = true;
			$(optGroup).next().find('INPUT:checkbox').each( function() {
				if( !$(this).is(':checked') ) {
					optGroupSelected = false;
					return false;
				}
			});
			
			$(optGroup).find('INPUT.optGroup').prop('checked', optGroupSelected).parent("LABEL").toggleClass('checked', optGroupSelected);
		}
	}
	
	// Update the textbox with the total number of selected items, and determine select all
	function updateSelected() {
		var multiSelect = $(this);
		var multiSelectOptions = multiSelect.next('.multiSelectOptions');
		var o = multiSelect.data("config");
		
		var i = 0;
		var selectAll = true;
		var display = '';
		multiSelectOptions.find('INPUT:checkbox').not('.selectAll, .optGroup').each( function() {
			if( $(this).is(':checked') ) {
				i++;
				display = display + $(this).parent().text() + ', ';
			}
			else selectAll = false;
		});
		
		// trim any end comma and surounding whitespace
		display = display.replace(/\s*\,\s*$/,'');
		
		if( i == 0 ) {
			multiSelect.find("span").html( o.noneSelected );
		} else {
			if( o.oneOrMoreSelected == '*' ) {
				multiSelect.find("span").html( display );
				multiSelect.attr( "title", display );
			} else {
				multiSelect.find("span").html( o.oneOrMoreSelected.replace('%', i) );
			}
		}

		// Determine if Select All should be checked
		if(o.selectAll) {
			multiSelectOptions.find('INPUT.selectAll').prop('checked', selectAll).parent("LABEL").toggleClass('checked', selectAll);
		}
	}
	
	$.extend($.fn, {
		multiSelect: function(o, callback) {
			// Default options
			if( !o ) o = {};
			o.selectAll = (o.selectAll === "true");
			if( o.selectAllText == undefined ) o.selectAllText = "Select All";
			if( o.noneSelected == undefined ) o.noneSelected = 'Select options';
			if( o.oneOrMoreSelected == undefined ) o.oneOrMoreSelected = '% selected';
			if( o.optGroupSelectable == undefined ) o.optGroupSelectable = false;
			if( o.listHeight == undefined ) o.listHeight = 150;

			// Initialize each multiSelect
			$(this).each( function() {
				var select = $(this);
				var html = '<a href="javascript:;" class="multiSelect" role="combobox" aria-haspopup="true" data-validation-type="'+select.attr("data-validation-type")+' data-isvalid="false"><span></span></a>';
				html += '<div class="multiSelectOptions" role="listbox" aria-hidden="true" style="position: absolute; z-index: 99999; visibility: hidden;"></div>';
				$(select).after(html);
				
				var multiSelect = $(select).next('.multiSelect');
				var multiSelectOptions = multiSelect.next('.multiSelectOptions');
				
				// if the select object had a width defined then match the new multilsect to it
				multiSelect.find("span").css("width", $(select).width() + 'px');
				
				// Attach the config options to the multiselect
				multiSelect.data("config", o);
				
				// Attach the callback to the multiselect
				multiSelect.data("callback", callback);
				
				// Serialize the select options into json options
				var options = [];
				$(select).children().each( function() {
					if(this.tagName.toUpperCase() == 'OPTGROUP')
					{
						var suboptions = [];
						options.push({ optgroup: $(this).attr('label'), options: suboptions });
						
						$(this).children('OPTION').each( function() {
							if( $(this).val() != '' ) {
								suboptions.push({ text: $(this).html(), value: $(this).val(), selected: $(this).attr('selected') });
							}
						});
					}
					else if(this.tagName.toUpperCase() == 'OPTION')
					{
						if( $(this).val() != '' ) {
							options.push({ text: $(this).html(), value: $(this).val(), selected: $(this).attr('selected') });
						}
					}
				});
				
				// Eliminate the original form element
				$(select).remove();
				
				// Add the id that was on the original select element to the new input
				multiSelect.attr("id", $(select).attr("id"));
				
				// Build the dropdown options
				buildOptions.call(multiSelect, options);

				// Events
				multiSelect.hover( function() {
					$(this).addClass('hover');
				}, function() {
					$(this).removeClass('hover');
				}).click( function() {
					// Show/hide on click
					if( $(this).hasClass('active') ) {
						$(this).multiSelectOptionsHide();
					} else {
						$(this).multiSelectOptionsShow();
					}
					return false;
				}).focus( function() {
					// So it can be styled with CSS
					$(this).addClass('focus');
				}).blur( function() {
					// So it can be styled with CSS
					var $this = $(this);
					$(this).removeClass('focus');
					
					setTimeout(function() {
						if( $this.parent().find('div.multiSelectOptions').css('visibility') != 'visible' ) {
							blur_fields($this);
						}
		        	}, 350);
					
				});
				
				// Add an event listener to the window to close the multiselect if the user clicks off
				$(document).click( function(event) {
					// If somewhere outside of the multiselect was clicked then hide the multiselect
					if(!($(event.target).parents().andSelf().is('.multiSelectOptions'))){
						multiSelect.multiSelectOptionsHide();
					}
				});
			});
		},
		
		// Update the dropdown options
		multiSelectOptionsUpdate: function(options) {
			buildOptions.call($(this), options);
		},
		
		// Hide the dropdown
		multiSelectOptionsHide: function() {
			if($(this).next('.multiSelectOptions').css('visibility') != 'hidden') {
				blur_fields($(this));
			}
			$(this).removeClass('active').removeClass('hover').next('.multiSelectOptions').attr("aria-hidden", "true").css('visibility', 'hidden');
		},
		
		// Show the dropdown
		multiSelectOptionsShow: function() {
			var multiSelect = $(this);
			var multiSelectOptions = multiSelect.next('.multiSelectOptions');
			var o = multiSelect.data("config");
		
			// Hide any open option boxes
			$('.multiSelect').multiSelectOptionsHide();
			multiSelectOptions.find('LABEL').removeClass('hover');
			multiSelect.addClass('active').next('.multiSelectOptions').css('visibility', 'visible');
			multiSelect.focus();
			
			// reset the scroll to the top
			multiSelect.next('.multiSelectOptions').scrollTop(0);

			// Position it
			var offset = multiSelect.position();
			multiSelect.next('.multiSelectOptions').css({ top:  offset.top + $(this).outerHeight() + 'px' });
			multiSelect.next('.multiSelectOptions').css({ left: offset.left + 'px' });
		},
		
		// get a coma-delimited list of selected values
		selectedValuesString: function() {
			var selectedValues = "";
			$(this).next('.multiSelectOptions').find('INPUT:checkbox:checked').not('.optGroup, .selectAll').each(function() {
				selectedValues += $(this).attr('value') + ",";
			});
			// trim any end comma and surounding whitespace
			return selectedValues.replace(/\s*\,\s*$/,'');
		}		
	});
	
	// add a new ":startsWith" search filter
	$.expr[":"].startsWith = function(el, i, m) {
		var search = m[3];        
		if (!search) return false;
		return eval("/^[/s]*" + search + "/i").test($(el).text());
	};
	
})(jQuery);
/*! Copyright 2012, Ben Lin (http://dreamerslab.com/)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Version: 1.0.19
 *
 * Requires: jQuery >= 1.2.3
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a);
}else{a(jQuery);}}(function(a){a.fn.addBack=a.fn.addBack||a.fn.andSelf;a.fn.extend({actual:function(b,l){if(!this[b]){throw'$.actual => The jQuery method "'+b+'" you called does not exist';
}var f={absolute:false,clone:false,includeMargin:false,display:"block"};var i=a.extend(f,l);var e=this.eq(0);var h,j;if(i.clone===true){h=function(){var m="position: absolute !important; top: -1000 !important; ";
e=e.clone().attr("style",m).appendTo("body");};j=function(){e.remove();};}else{var g=[];var d="";var c;h=function(){c=e.parents().addBack().filter(":hidden");
d+="visibility: hidden !important; display: "+i.display+" !important; ";if(i.absolute===true){d+="position: absolute !important; ";}c.each(function(){var m=a(this);
var n=m.attr("style");g.push(n);m.attr("style",n?n+";"+d:d);});};j=function(){c.each(function(m){var o=a(this);var n=g[m];if(n===undefined){o.removeAttr("style");
}else{o.attr("style",n);}});};}h();var k=/(outer)/.test(b)?e[b](i.includeMargin):e[b]();j();return k;}});}));

/* Modernizr 2.8.3 (Custom Build) | MIT & BSD
 * Build: http://modernizr.com/download/#-fontface-backgroundsize-borderimage-borderradius-boxshadow-flexbox-flexboxlegacy-hsla-multiplebgs-opacity-rgba-textshadow-cssanimations-csscolumns-generatedcontent-cssgradients-cssreflections-csstransforms-csstransforms3d-csstransitions-applicationcache-canvas-canvastext-draganddrop-hashchange-history-audio-video-indexeddb-input-inputtypes-localstorage-postmessage-sessionstorage-websockets-websqldatabase-webworkers-geolocation-inlinesvg-smil-svg-svgclippaths-touch-webgl-shiv-mq-cssclasses-teststyles-testprop-testallprops-hasevent-prefixes-domprefixes-load-cssclassprefix:ntt!
 */
;window.Modernizr=function(a,b,c){function D(a){j.cssText=a}function E(a,b){return D(n.join(a+";")+(b||""))}function F(a,b){return typeof a===b}function G(a,b){return!!~(""+a).indexOf(b)}function H(a,b){for(var d in a){var e=a[d];if(!G(e,"-")&&j[e]!==c)return b=="pfx"?e:!0}return!1}function I(a,b,d){for(var e in a){var f=b[a[e]];if(f!==c)return d===!1?a[e]:F(f,"function")?f.bind(d||b):f}return!1}function J(a,b,c){var d=a.charAt(0).toUpperCase()+a.slice(1),e=(a+" "+p.join(d+" ")+d).split(" ");return F(b,"string")||F(b,"undefined")?H(e,b):(e=(a+" "+q.join(d+" ")+d).split(" "),I(e,b,c))}function K(){e.input=function(c){for(var d=0,e=c.length;d<e;d++)u[c[d]]=c[d]in k;return u.list&&(u.list=!!b.createElement("datalist")&&!!a.HTMLDataListElement),u}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),e.inputtypes=function(a){for(var d=0,e,f,h,i=a.length;d<i;d++)k.setAttribute("type",f=a[d]),e=k.type!=="text",e&&(k.value=l,k.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(f)&&k.style.WebkitAppearance!==c?(g.appendChild(k),h=b.defaultView,e=h.getComputedStyle&&h.getComputedStyle(k,null).WebkitAppearance!=="textfield"&&k.offsetHeight!==0,g.removeChild(k)):/^(search|tel)$/.test(f)||(/^(url|email)$/.test(f)?e=k.checkValidity&&k.checkValidity()===!1:e=k.value!=l)),t[a[d]]=!!e;return t}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var d="2.8.3",e={},f=!0,g=b.documentElement,h="modernizr",i=b.createElement(h),j=i.style,k=b.createElement("input"),l=":)",m={}.toString,n=" -webkit- -moz- -o- -ms- ".split(" "),o="Webkit Moz O ms",p=o.split(" "),q=o.toLowerCase().split(" "),r={svg:"http://www.w3.org/2000/svg"},s={},t={},u={},v=[],w=v.slice,x,y=function(a,c,d,e){var f,i,j,k,l=b.createElement("div"),m=b.body,n=m||b.createElement("body");if(parseInt(d,10))while(d--)j=b.createElement("div"),j.id=e?e[d]:h+(d+1),l.appendChild(j);return f=["&#173;",'<style id="s',h,'">',a,"</style>"].join(""),l.id=h,(m?l:n).innerHTML+=f,n.appendChild(l),m||(n.style.background="",n.style.overflow="hidden",k=g.style.overflow,g.style.overflow="hidden",g.appendChild(n)),i=c(l,a),m?l.parentNode.removeChild(l):(n.parentNode.removeChild(n),g.style.overflow=k),!!i},z=function(b){var c=a.matchMedia||a.msMatchMedia;if(c)return c(b)&&c(b).matches||!1;var d;return y("@media "+b+" { #"+h+" { position: absolute; } }",function(b){d=(a.getComputedStyle?getComputedStyle(b,null):b.currentStyle)["position"]=="absolute"}),d},A=function(){function d(d,e){e=e||b.createElement(a[d]||"div"),d="on"+d;var f=d in e;return f||(e.setAttribute||(e=b.createElement("div")),e.setAttribute&&e.removeAttribute&&(e.setAttribute(d,""),f=F(e[d],"function"),F(e[d],"undefined")||(e[d]=c),e.removeAttribute(d))),e=null,f}var a={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return d}(),B={}.hasOwnProperty,C;!F(B,"undefined")&&!F(B.call,"undefined")?C=function(a,b){return B.call(a,b)}:C=function(a,b){return b in a&&F(a.constructor.prototype[b],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(b){var c=this;if(typeof c!="function")throw new TypeError;var d=w.call(arguments,1),e=function(){if(this instanceof e){var a=function(){};a.prototype=c.prototype;var f=new a,g=c.apply(f,d.concat(w.call(arguments)));return Object(g)===g?g:f}return c.apply(b,d.concat(w.call(arguments)))};return e}),s.flexbox=function(){return J("flexWrap")},s.flexboxlegacy=function(){return J("boxDirection")},s.canvas=function(){var a=b.createElement("canvas");return!!a.getContext&&!!a.getContext("2d")},s.canvastext=function(){return!!e.canvas&&!!F(b.createElement("canvas").getContext("2d").fillText,"function")},s.webgl=function(){return!!a.WebGLRenderingContext},s.touch=function(){var c;return"ontouchstart"in a||a.DocumentTouch&&b instanceof DocumentTouch?c=!0:y(["@media (",n.join("touch-enabled),("),h,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(a){c=a.offsetTop===9}),c},s.geolocation=function(){return"geolocation"in navigator},s.postmessage=function(){return!!a.postMessage},s.websqldatabase=function(){return!!a.openDatabase},s.indexedDB=function(){return!!J("indexedDB",a)},s.hashchange=function(){return A("hashchange",a)&&(b.documentMode===c||b.documentMode>7)},s.history=function(){return!!a.history&&!!history.pushState},s.draganddrop=function(){var a=b.createElement("div");return"draggable"in a||"ondragstart"in a&&"ondrop"in a},s.websockets=function(){return"WebSocket"in a||"MozWebSocket"in a},s.rgba=function(){return D("background-color:rgba(150,255,150,.5)"),G(j.backgroundColor,"rgba")},s.hsla=function(){return D("background-color:hsla(120,40%,100%,.5)"),G(j.backgroundColor,"rgba")||G(j.backgroundColor,"hsla")},s.multiplebgs=function(){return D("background:url(https://),url(https://),red url(https://)"),/(url\s*\(.*?){3}/.test(j.background)},s.backgroundsize=function(){return J("backgroundSize")},s.borderimage=function(){return J("borderImage")},s.borderradius=function(){return J("borderRadius")},s.boxshadow=function(){return J("boxShadow")},s.textshadow=function(){return b.createElement("div").style.textShadow===""},s.opacity=function(){return E("opacity:.55"),/^0.55$/.test(j.opacity)},s.cssanimations=function(){return J("animationName")},s.csscolumns=function(){return J("columnCount")},s.cssgradients=function(){var a="background-image:",b="gradient(linear,left top,right bottom,from(#9f9),to(white));",c="linear-gradient(left top,#9f9, white);";return D((a+"-webkit- ".split(" ").join(b+a)+n.join(c+a)).slice(0,-a.length)),G(j.backgroundImage,"gradient")},s.cssreflections=function(){return J("boxReflect")},s.csstransforms=function(){return!!J("transform")},s.csstransforms3d=function(){var a=!!J("perspective");return a&&"webkitPerspective"in g.style&&y("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(b,c){a=b.offsetLeft===9&&b.offsetHeight===3}),a},s.csstransitions=function(){return J("transition")},s.fontface=function(){var a;return y('@font-face {font-family:"font";src:url("https://")}',function(c,d){var e=b.getElementById("smodernizr"),f=e.sheet||e.styleSheet,g=f?f.cssRules&&f.cssRules[0]?f.cssRules[0].cssText:f.cssText||"":"";a=/src/i.test(g)&&g.indexOf(d.split(" ")[0])===0}),a},s.generatedcontent=function(){var a;return y(["#",h,"{font:0/0 a}#",h,':after{content:"',l,'";visibility:hidden;font:3px/1 a}'].join(""),function(b){a=b.offsetHeight>=3}),a},s.video=function(){var a=b.createElement("video"),c=!1;try{if(c=!!a.canPlayType)c=new Boolean(c),c.ogg=a.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),c.h264=a.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),c.webm=a.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")}catch(d){}return c},s.audio=function(){var a=b.createElement("audio"),c=!1;try{if(c=!!a.canPlayType)c=new Boolean(c),c.ogg=a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),c.mp3=a.canPlayType("audio/mpeg;").replace(/^no$/,""),c.wav=a.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),c.m4a=(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/aac;")).replace(/^no$/,"")}catch(d){}return c},s.localstorage=function(){try{return localStorage.setItem(h,h),localStorage.removeItem(h),!0}catch(a){return!1}},s.sessionstorage=function(){try{return sessionStorage.setItem(h,h),sessionStorage.removeItem(h),!0}catch(a){return!1}},s.webworkers=function(){return!!a.Worker},s.applicationcache=function(){return!!a.applicationCache},s.svg=function(){return!!b.createElementNS&&!!b.createElementNS(r.svg,"svg").createSVGRect},s.inlinesvg=function(){var a=b.createElement("div");return a.innerHTML="<svg/>",(a.firstChild&&a.firstChild.namespaceURI)==r.svg},s.smil=function(){return!!b.createElementNS&&/SVGAnimate/.test(m.call(b.createElementNS(r.svg,"animate")))},s.svgclippaths=function(){return!!b.createElementNS&&/SVGClipPath/.test(m.call(b.createElementNS(r.svg,"clipPath")))};for(var L in s)C(s,L)&&(x=L.toLowerCase(),e[x]=s[L](),v.push((e[x]?"":"no-")+x));return e.input||K(),e.addTest=function(a,b){if(typeof a=="object")for(var d in a)C(a,d)&&e.addTest(d,a[d]);else{a=a.toLowerCase();if(e[a]!==c)return e;b=typeof b=="function"?b():b,typeof f!="undefined"&&f&&(g.className+=" ntt-"+(b?"":"no-")+a),e[a]=b}return e},D(""),i=k=null,function(a,b){function l(a,b){var c=a.createElement("p"),d=a.getElementsByTagName("head")[0]||a.documentElement;return c.innerHTML="x<style>"+b+"</style>",d.insertBefore(c.lastChild,d.firstChild)}function m(){var a=s.elements;return typeof a=="string"?a.split(" "):a}function n(a){var b=j[a[h]];return b||(b={},i++,a[h]=i,j[i]=b),b}function o(a,c,d){c||(c=b);if(k)return c.createElement(a);d||(d=n(c));var g;return d.cache[a]?g=d.cache[a].cloneNode():f.test(a)?g=(d.cache[a]=d.createElem(a)).cloneNode():g=d.createElem(a),g.canHaveChildren&&!e.test(a)&&!g.tagUrn?d.frag.appendChild(g):g}function p(a,c){a||(a=b);if(k)return a.createDocumentFragment();c=c||n(a);var d=c.frag.cloneNode(),e=0,f=m(),g=f.length;for(;e<g;e++)d.createElement(f[e]);return d}function q(a,b){b.cache||(b.cache={},b.createElem=a.createElement,b.createFrag=a.createDocumentFragment,b.frag=b.createFrag()),a.createElement=function(c){return s.shivMethods?o(c,a,b):b.createElem(c)},a.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+m().join().replace(/[\w\-]+/g,function(a){return b.createElem(a),b.frag.createElement(a),'c("'+a+'")'})+");return n}")(s,b.frag)}function r(a){a||(a=b);var c=n(a);return s.shivCSS&&!g&&!c.hasCSS&&(c.hasCSS=!!l(a,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),k||q(a,c),a}var c="3.7.0",d=a.html5||{},e=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,f=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,g,h="_html5shiv",i=0,j={},k;(function(){try{var a=b.createElement("a");a.innerHTML="<xyz></xyz>",g="hidden"in a,k=a.childNodes.length==1||function(){b.createElement("a");var a=b.createDocumentFragment();return typeof a.cloneNode=="undefined"||typeof a.createDocumentFragment=="undefined"||typeof a.createElement=="undefined"}()}catch(c){g=!0,k=!0}})();var s={elements:d.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:c,shivCSS:d.shivCSS!==!1,supportsUnknownElements:k,shivMethods:d.shivMethods!==!1,type:"default",shivDocument:r,createElement:o,createDocumentFragment:p};a.html5=s,r(b)}(this,b),e._version=d,e._prefixes=n,e._domPrefixes=q,e._cssomPrefixes=p,e.mq=z,e.hasEvent=A,e.testProp=function(a){return H([a])},e.testAllProps=J,e.testStyles=y,g.className=g.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(f?" ntt-js ntt-"+v.join(" ntt-"):""),e}(this,this.document),function(a,b,c){function d(a){return"[object Function]"==o.call(a)}function e(a){return"string"==typeof a}function f(){}function g(a){return!a||"loaded"==a||"complete"==a||"uninitialized"==a}function h(){var a=p.shift();q=1,a?a.t?m(function(){("c"==a.t?B.injectCss:B.injectJs)(a.s,0,a.a,a.x,a.e,1)},0):(a(),h()):q=0}function i(a,c,d,e,f,i,j){function k(b){if(!o&&g(l.readyState)&&(u.r=o=1,!q&&h(),l.onload=l.onreadystatechange=null,b)){"img"!=a&&m(function(){t.removeChild(l)},50);for(var d in y[c])y[c].hasOwnProperty(d)&&y[c][d].onload()}}var j=j||B.errorTimeout,l=b.createElement(a),o=0,r=0,u={t:d,s:c,e:f,a:i,x:j};1===y[c]&&(r=1,y[c]=[]),"object"==a?l.data=c:(l.src=c,l.type=a),l.width=l.height="0",l.onerror=l.onload=l.onreadystatechange=function(){k.call(this,r)},p.splice(e,0,u),"img"!=a&&(r||2===y[c]?(t.insertBefore(l,s?null:n),m(k,j)):y[c].push(l))}function j(a,b,c,d,f){return q=0,b=b||"j",e(a)?i("c"==b?v:u,a,b,this.i++,c,d,f):(p.splice(this.i++,0,a),1==p.length&&h()),this}function k(){var a=B;return a.loader={load:j,i:0},a}var l=b.documentElement,m=a.setTimeout,n=b.getElementsByTagName("script")[0],o={}.toString,p=[],q=0,r="MozAppearance"in l.style,s=r&&!!b.createRange().compareNode,t=s?l:n.parentNode,l=a.opera&&"[object Opera]"==o.call(a.opera),l=!!b.attachEvent&&!l,u=r?"object":l?"script":"img",v=l?"script":u,w=Array.isArray||function(a){return"[object Array]"==o.call(a)},x=[],y={},z={timeout:function(a,b){return b.length&&(a.timeout=b[0]),a}},A,B;B=function(a){function b(a){var a=a.split("!"),b=x.length,c=a.pop(),d=a.length,c={url:c,origUrl:c,prefixes:a},e,f,g;for(f=0;f<d;f++)g=a[f].split("="),(e=z[g.shift()])&&(c=e(c,g));for(f=0;f<b;f++)c=x[f](c);return c}function g(a,e,f,g,h){var i=b(a),j=i.autoCallback;i.url.split(".").pop().split("?").shift(),i.bypass||(e&&(e=d(e)?e:e[a]||e[g]||e[a.split("/").pop().split("?")[0]]),i.instead?i.instead(a,e,f,g,h):(y[i.url]?i.noexec=!0:y[i.url]=1,f.load(i.url,i.forceCSS||!i.forceJS&&"css"==i.url.split(".").pop().split("?").shift()?"c":c,i.noexec,i.attrs,i.timeout),(d(e)||d(j))&&f.load(function(){k(),e&&e(i.origUrl,h,g),j&&j(i.origUrl,h,g),y[i.url]=2})))}function h(a,b){function c(a,c){if(a){if(e(a))c||(j=function(){var a=[].slice.call(arguments);k.apply(this,a),l()}),g(a,j,b,0,h);else if(Object(a)===a)for(n in m=function(){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b}(),a)a.hasOwnProperty(n)&&(!c&&!--m&&(d(j)?j=function(){var a=[].slice.call(arguments);k.apply(this,a),l()}:j[n]=function(a){return function(){var b=[].slice.call(arguments);a&&a.apply(this,b),l()}}(k[n])),g(a[n],j,b,n,h))}else!c&&l()}var h=!!a.test,i=a.load||a.both,j=a.callback||f,k=j,l=a.complete||f,m,n;c(h?a.yep:a.nope,!!i),i&&c(i)}var i,j,l=this.yepnope.loader;if(e(a))g(a,0,l,0);else if(w(a))for(i=0;i<a.length;i++)j=a[i],e(j)?g(j,0,l,0):w(j)?B(j):Object(j)===j&&h(j,l);else Object(a)===a&&h(a,l)},B.addPrefix=function(a,b){z[a]=b},B.addFilter=function(a){x.push(a)},B.errorTimeout=1e4,null==b.readyState&&b.addEventListener&&(b.readyState="loading",b.addEventListener("DOMContentLoaded",A=function(){b.removeEventListener("DOMContentLoaded",A,0),b.readyState="complete"},0)),a.yepnope=k(),a.yepnope.executeStack=h,a.yepnope.injectJs=function(a,c,d,e,i,j){var k=b.createElement("script"),l,o,e=e||B.errorTimeout;k.src=a;for(o in d)k.setAttribute(o,d[o]);c=j?h:c||f,k.onreadystatechange=k.onload=function(){!l&&g(k.readyState)&&(l=1,c(),k.onload=k.onreadystatechange=null)},m(function(){l||(l=1,c(1))},e),i?k.onload():n.parentNode.insertBefore(k,n)},a.yepnope.injectCss=function(a,c,d,e,g,i){var e=b.createElement("link"),j,c=i?h:c||f;e.href=a,e.rel="stylesheet",e.type="text/css";for(j in d)e.setAttribute(j,d[j]);g||(n.parentNode.insertBefore(e,n),m(c,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))};
/*
 * jQuery Templates Plugin 1.0.0pre
 * http://github.com/jquery/jquery-tmpl
 * Requires jQuery 1.4.2
 *
 * Copyright 2011, Software Freedom Conservancy, Inc.
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 */
(function(a) {
	var r = a.fn.domManip, d = "_tmplitem", q = /^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /, b = {}, f = {}, e, p = {
		key : 0,
		data : {}
	}, i = 0, c = 0, l = [];
	function g(g, d, h, e) {
		var c = {
			data : e || (e === 0 || e === false) ? e : d ? d.data : {},
			_wrap : d ? d._wrap : null,
			tmpl : null,
			parent : d || null,
			nodes : [],
			calls : u,
			nest : w,
			wrap : x,
			html : v,
			update : t
		};
		g && a.extend(c, g, {
			nodes : [],
			parent : d
		});
		if (h) {
			c.tmpl = h;
			c._ctnt = c._ctnt || c.tmpl(a, c);
			c.key = ++i;
			(l.length ? f : b)[i] = c
		}
		return c
	}
	a.each({
		appendTo : "append",
		prependTo : "prepend",
		insertBefore : "before",
		insertAfter : "after",
		replaceAll : "replaceWith"
	}, function(f, d) {
		a.fn[f] = function(n) {
			var g = [], i = a(n), k, h, m, l, j = this.length === 1
					&& this[0].parentNode;
			e = b || {};
			if (j && j.nodeType === 11 && j.childNodes.length === 1
					&& i.length === 1) {
				i[d](this[0]);
				g = this
			} else {
				for (h = 0, m = i.length; h < m; h++) {
					c = h;
					k = (h > 0 ? this.clone(true) : this).get();
					a(i[h])[d](k);
					g = g.concat(k)
				}
				c = 0;
				g = this.pushStack(g, f, i.selector)
			}
			l = e;
			e = null;
			a.tmpl.complete(l);
			return g
		}
	});
	a.fn
			.extend({
				tmpl : function(d, c, b) {
					return a.tmpl(this[0], d, c, b)
				},
				tmplItem : function() {
					return a.tmplItem(this[0])
				},
				template : function(b) {
					return a.template(b, this[0])
				},
				domManip : function(d, m, k) {
					if (d[0] && a.isArray(d[0])) {
						var g = a.makeArray(arguments), h = d[0], j = h.length, i = 0, f;
						while (i < j && !(f = a.data(h[i++], "tmplItem")))
							;
						if (f && c)
							g[2] = function(b) {
								a.tmpl.afterManip(this, b, k)
							};
						r.apply(this, g)
					} else
						r.apply(this, arguments);
					c = 0;
					!e && a.tmpl.complete(b);
					return this
				}
			});
	a.extend({
		tmpl : function(d, h, e, c) {
			var i, k = !c;
			if (k) {
				c = p;
				d = a.template[d] || a.template(null, d);
				f = {}
			} else if (!d) {
				d = c.tmpl;
				b[c.key] = c;
				c.nodes = [];
				c.wrapped && n(c, c.wrapped);
				return a(j(c, null, c.tmpl(a, c)))
			}
			if (!d)
				return [];
			if (typeof h === "function")
				h = h.call(c || {});
			e && e.wrapped && n(e, e.wrapped);
			i = a.isArray(h) ? a.map(h, function(a) {
				return a ? g(e, c, d, a) : null
			}) : [ g(e, c, d, h) ];
			return k ? a(j(c, null, i)) : i
		},
		tmplItem : function(b) {
			var c;
			if (b instanceof a)
				b = b[0];
			while (b && b.nodeType === 1 && !(c = a.data(b, "tmplItem"))
					&& (b = b.parentNode))
				;
			return c || p
		},
		template : function(c, b) {
			if (b) {
				if (typeof b === "string")
					b = o(b);
				else if (b instanceof a)
					b = b[0] || {};
				if (b.nodeType)
					b = a.data(b, "tmpl") || a.data(b, "tmpl", o(b.innerHTML));
				return typeof c === "string" ? (a.template[c] = b) : b
			}
			return c ? typeof c !== "string" ? a.template(null, c)
					: a.template[c] || a.template(null, q.test(c) ? c : a(c))
					: null
		},
		encode : function(a) {
			return ("" + a).split("<").join("&lt;").split(">").join("&gt;")
					.split('"').join("&#34;").split("'").join("&#39;")
		}
	});
	a
			.extend(
					a.tmpl,
					{
						tag : {
							tmpl : {
								_default : {
									$2 : "null"
								},
								open : "if($notnull_1){__=__.concat($item.nest($1,$2));}"
							},
							wrap : {
								_default : {
									$2 : "null"
								},
								open : "$item.calls(__,$1,$2);__=[];",
								close : "call=$item.calls();__=call._.concat($item.wrap(call,__));"
							},
							each : {
								_default : {
									$2 : "$index, $value"
								},
								open : "if($notnull_1){$.each($1a,function($2){with(this){",
								close : "}});}"
							},
							"if" : {
								open : "if(($notnull_1) && $1a){",
								close : "}"
							},
							"else" : {
								_default : {
									$1 : "true"
								},
								open : "}else if(($notnull_1) && $1a){"
							},
							html : {
								open : "if($notnull_1){__.push($1a);}"
							},
							"=" : {
								_default : {
									$1 : "$data"
								},
								open : "if($notnull_1){__.push($.encode($1a));}"
							},
							"!" : {
								open : ""
							}
						},
						complete : function() {
							b = {}
						},
						afterManip : function(f, b, d) {
							var e = b.nodeType === 11 ? a
									.makeArray(b.childNodes)
									: b.nodeType === 1 ? [ b ] : [];
							d.call(f, b);
							m(e);
							c++
						}
					});
	function j(e, g, f) {
		var b, c = f ? a.map(f, function(a) {
			return typeof a === "string" ? e.key ? a.replace(
					/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g, "$1 " + d
							+ '="' + e.key + '" $2') : a : j(a, e, a._ctnt)
		}) : e;
		if (g)
			return c;
		c = c.join("");
		c.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/, function(
				f, c, e, d) {
			b = a(e).get();
			m(b);
			if (c)
				b = k(c).concat(b);
			if (d)
				b = b.concat(k(d))
		});
		return b ? b : k(c)
	}
	function k(c) {
		var b = document.createElement("div");
		b.innerHTML = c;
		return a.makeArray(b.childNodes)
	}
	function o(b) {
		return new Function(
				"jQuery",
				"$item",
				"var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"
						+ a
								.trim(b)
								.replace(/([\\'])/g, "\\$1")
								.replace(/[\r\t\n]/g, " ")
								.replace(/\$\{([^\}]*)\}/g, "{{= $1}}")
								.replace(
										/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,
										function(m, l, k, g, b, c, d) {
											var j = a.tmpl.tag[k], i, e, f;
											if (!j)
												throw "Unknown template tag: "
														+ k;
											i = j._default || [];
											if (c && !/\w$/.test(b)) {
												b += c;
												c = ""
											}
											if (b) {
												b = h(b);
												d = d ? "," + h(d) + ")"
														: c ? ")" : "";
												e = c ? b.indexOf(".") > -1 ? b
														+ h(c) : "(" + b
														+ ").call($item" + d
														: b;
												f = c ? e : "(typeof(" + b
														+ ")==='function'?("
														+ b + ").call($item):("
														+ b + "))"
											} else
												f = e = i.$1 || "null";
											g = h(g);
											return "');"
													+ j[l ? "close" : "open"]
															.split("$notnull_1")
															.join(
																	b ? "typeof("
																			+ b
																			+ ")!=='undefined' && ("
																			+ b
																			+ ")!=null"
																			: "true")
															.split("$1a")
															.join(f)
															.split("$1")
															.join(e)
															.split("$2")
															.join(
																	g
																			|| i.$2
																			|| "")
													+ "__.push('"
										}) + "');}return __;")
	}
	function n(c, b) {
		c._wrap = j(c, true, a.isArray(b) ? b : [ q.test(b) ? b : a(b).html() ])
				.join("")
	}
	function h(a) {
		return a ? a.replace(/\\'/g, "'").replace(/\\\\/g, "\\") : null
	}
	function s(b) {
		var a = document.createElement("div");
		a.appendChild(b.cloneNode(true));
		return a.innerHTML
	}
	function m(o) {
		var n = "_" + c, k, j, l = {}, e, p, h;
		for (e = 0, p = o.length; e < p; e++) {
			if ((k = o[e]).nodeType !== 1)
				continue;
			j = k.getElementsByTagName("*");
			for (h = j.length - 1; h >= 0; h--)
				m(j[h]);
			m(k)
		}
		function m(j) {
			var p, h = j, k, e, m;
			if (m = j.getAttribute(d)) {
				while (h.parentNode && (h = h.parentNode).nodeType === 1
						&& !(p = h.getAttribute(d)))
					;
				if (p !== m) {
					h = h.parentNode ? h.nodeType === 11 ? 0 : h
							.getAttribute(d) || 0 : 0;
					if (!(e = b[m])) {
						e = f[m];
						e = g(e, b[h] || f[h]);
						e.key = ++i;
						b[i] = e
					}
					c && o(m)
				}
				j.removeAttribute(d)
			} else if (c && (e = a.data(j, "tmplItem"))) {
				o(e.key);
				b[e.key] = e;
				h = a.data(j.parentNode, "tmplItem");
				h = h ? h.key : 0
			}
			if (e) {
				k = e;
				while (k && k.key != h) {
					k.nodes.push(j);
					k = k.parent
				}
				delete e._ctnt;
				delete e._wrap;
				a.data(j, "tmplItem", e)
			}
			function o(a) {
				a = a + n;
				e = l[a] = l[a] || g(e, b[e.parent.key + n] || e.parent)
			}
		}
	}
	function u(a, d, c, b) {
		if (!a)
			return l.pop();
		l.push({
			_ : a,
			tmpl : d,
			item : this,
			data : c,
			options : b
		})
	}
	function w(d, c, b) {
		return a.tmpl(a.template(d), c, b, this)
	}
	function x(b, d) {
		var c = b.options || {};
		c.wrapped = d;
		return a.tmpl(a.template(b.tmpl), b.data, c, b.item)
	}
	function v(d, c) {
		var b = this._wrap;
		return a.map(a(a.isArray(b) ? b.join("") : b).filter(d || "*"),
				function(a) {
					return c ? a.innerText || a.textContent : a.outerHTML
							|| s(a)
				})
	}
	function t() {
		var b = this.nodes;
		a.tmpl(null, null, null, this).insertBefore(b[0]);
		a(b).remove()
	}
})(jQuery);
var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

(function (global, factory) {
    (typeof exports === 'undefined' ? 'undefined' : _typeof(exports)) === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : global.LazyLoad = factory();
})(this, function () {
    'use strict';

    var defaultSettings = {
        elements_selector: "img",
        container: window,
        threshold: 300,
        throttle: 150,
        data_src: "original",
        data_srcset: "originalSet",
        class_loading: "loading",
        class_loaded: "loaded",
        class_error: "error",
        class_initial: "initial",
        skip_invisible: true,
        callback_load: null,
        callback_error: null,
        callback_set: null,
        callback_processed: null
    };

    var isBot = !("onscroll" in window) || /glebot/.test(navigator.userAgent);

    var callCallback = function callCallback(callback, argument) {
        if (callback) {
            callback(argument);
        }
    };

    var getTopOffset = function getTopOffset(element) {
        return element.getBoundingClientRect().top + window.pageYOffset - element.ownerDocument.documentElement.clientTop;
    };

    var isBelowViewport = function isBelowViewport(element, container, threshold) {
        var fold = container === window ? window.innerHeight + window.pageYOffset : getTopOffset(container) + container.offsetHeight;
        return fold <= getTopOffset(element) - threshold;
    };

    var getLeftOffset = function getLeftOffset(element) {
        return element.getBoundingClientRect().left + window.pageXOffset - element.ownerDocument.documentElement.clientLeft;
    };

    var isAtRightOfViewport = function isAtRightOfViewport(element, container, threshold) {
        var documentWidth = window.innerWidth;
        var fold = container === window ? documentWidth + window.pageXOffset : getLeftOffset(container) + documentWidth;
        return fold <= getLeftOffset(element) - threshold;
    };

    var isAboveViewport = function isAboveViewport(element, container, threshold) {
        var fold = container === window ? window.pageYOffset : getTopOffset(container);
        return fold >= getTopOffset(element) + threshold + element.offsetHeight;
    };

    var isAtLeftOfViewport = function isAtLeftOfViewport(element, container, threshold) {
        var fold = container === window ? window.pageXOffset : getLeftOffset(container);
        return fold >= getLeftOffset(element) + threshold + element.offsetWidth;
    };

    var isInsideViewport = function isInsideViewport(element, container, threshold) {
        return !isBelowViewport(element, container, threshold) && !isAboveViewport(element, container, threshold) && !isAtRightOfViewport(element, container, threshold) && !isAtLeftOfViewport(element, container, threshold);
    };

    /* Creates instance and notifies it through the window element */
    var createInstance = function createInstance(classObj, options) {
        var instance = new classObj(options);
        var event = new CustomEvent("LazyLoad::Initialized", { detail: { instance: instance } });
        window.dispatchEvent(event);
    };

    /* Auto initialization of one or more instances of lazyload, depending on the 
        options passed in (plain object or an array) */
    var autoInitialize = function autoInitialize(classObj, options) {
        var optsLength = options.length;
        if (!optsLength) {
            // Plain object
            createInstance(classObj, options);
        } else {
            // Array of objects
            for (var i = 0; i < optsLength; i++) {
                createInstance(classObj, options[i]);
            }
        }
    };

    var setSourcesForPicture = function setSourcesForPicture(element, srcsetDataAttribute) {
        var parent = element.parentElement;
        if (parent.tagName !== "PICTURE") {
            return;
        }
        for (var i = 0; i < parent.children.length; i++) {
            var pictureChild = parent.children[i];
            if (pictureChild.tagName === "SOURCE") {
                var sourceSrcset = pictureChild.dataset[srcsetDataAttribute];
                if (sourceSrcset) {
                    pictureChild.setAttribute("srcset", sourceSrcset);
                }
            }
        }
    };

    var setSources = function setSources(element, srcsetDataAttribute, srcDataAttribute) {
        var tagName = element.tagName;
        var elementSrc = element.dataset[srcDataAttribute];
        if (tagName === "IMG") {
            setSourcesForPicture(element, srcsetDataAttribute);
            var imgSrcset = element.dataset[srcsetDataAttribute];
            if (imgSrcset) {
                element.setAttribute("srcset", imgSrcset);
            }
            if (elementSrc) {
                element.setAttribute("src", elementSrc);
            }
            return;
        }
        if (tagName === "IFRAME") {
            if (elementSrc) {
                element.setAttribute("src", elementSrc);
            }
            return;
        }
        if (elementSrc) {
            var bkgImage = element.style.backgroundImage;
            if(bkgImage){
            	bkgImage = bkgImage.substring(5, bkgImage.length - 2);
            }
            
            if(elementSrc != bkgImage)
            	element.style.backgroundImage = "url(" + elementSrc + ")";
        }
    };

    /*
     * Constructor
     */

    var LazyLoad = function LazyLoad(instanceSettings) {
        this._settings = _extends({}, defaultSettings, instanceSettings);
        this._queryOriginNode = this._settings.container === window ? document : this._settings.container;

        this._previousLoopTime = 0;
        this._loopTimeout = null;
        this._boundHandleScroll = this.handleScroll.bind(this);

        this._isFirstLoop = true;
        window.addEventListener("resize", this._boundHandleScroll);
        this.update();
    };

    LazyLoad.prototype = {

        /*
         * Private methods
         */

        _reveal: function _reveal(element) {
            var settings = this._settings;

            var errorCallback = function errorCallback() {
                /* As this method is asynchronous, it must be protected against external destroy() calls */
                if (!settings) {
                    return;
                }
                element.removeEventListener("load", loadCallback);
                element.removeEventListener("error", errorCallback);
                element.classList.remove(settings.class_loading);
                element.classList.add(settings.class_error);
                callCallback(settings.callback_error, element);
            };

            var loadCallback = function loadCallback() {
                /* As this method is asynchronous, it must be protected against external destroy() calls */
                if (!settings) {
                    return;
                }
                element.classList.remove(settings.class_loading);
                element.classList.add(settings.class_loaded);
                element.removeEventListener("load", loadCallback);
                element.removeEventListener("error", errorCallback);
                /* Calling LOAD callback */
                callCallback(settings.callback_load, element);
            };

            if (element.tagName === "IMG" || element.tagName === "IFRAME") {
                element.addEventListener("load", loadCallback);
                element.addEventListener("error", errorCallback);
                element.classList.add(settings.class_loading);
            }

            setSources(element, settings.data_srcset, settings.data_src);
            /* Calling SET callback */
            callCallback(settings.callback_set, element);
        },

        _loopThroughElements: function _loopThroughElements() {
            var settings = this._settings,
                elements = this._elements,
                elementsLength = !elements ? 0 : elements.length;
            var i = void 0,
                processedIndexes = [],
                firstLoop = this._isFirstLoop;

            for (i = 0; i < elementsLength; i++) {
                var element = elements[i];
                /* If must skip_invisible and element is invisible, skip it */
                if (settings.skip_invisible && element.offsetParent === null) {
                    continue;
                }

                if (isBot || isInsideViewport(element, settings.container, settings.threshold)) {
                    if (firstLoop) {
                        element.classList.add(settings.class_initial);
                    }
                    /* Start loading the image */
                    this._reveal(element);
                    /* Marking the element as processed. */
                    processedIndexes.push(i);
                    element.dataset.wasProcessed = true;
                }
            }
            /* Removing processed elements from this._elements. */
            while (processedIndexes.length > 0) {
                elements.splice(processedIndexes.pop(), 1);
                /* Calling the end loop callback */
                callCallback(settings.callback_processed, elements.length);
            }
            /* Stop listening to scroll event when 0 elements remains */
            if (elementsLength === 0) {
                this._stopScrollHandler();
            }
            /* Sets isFirstLoop to false */
            if (firstLoop) {
                this._isFirstLoop = false;
            }
        },

        _purgeElements: function _purgeElements() {
            var elements = this._elements,
                elementsLength = elements.length;
            var i = void 0,
                elementsToPurge = [];

            for (i = 0; i < elementsLength; i++) {
                var element = elements[i];
                /* If the element has already been processed, skip it */
                if (element.dataset.wasProcessed) {
                    elementsToPurge.push(i);
                }
            }
            /* Removing elements to purge from this._elements. */
            while (elementsToPurge.length > 0) {
                elements.splice(elementsToPurge.pop(), 1);
            }
        },

        _startScrollHandler: function _startScrollHandler() {
            if (!this._isHandlingScroll) {
                this._isHandlingScroll = true;
                this._settings.container.addEventListener("scroll", this._boundHandleScroll);
            }
        },

        _stopScrollHandler: function _stopScrollHandler() {
            if (this._isHandlingScroll) {
                this._isHandlingScroll = false;
                this._settings.container.removeEventListener("scroll", this._boundHandleScroll);
            }
        },

        /* 
         * Public methods
         */

        handleScroll: function handleScroll() {
            var throttle = this._settings.throttle;

            if (throttle !== 0) {
                var getTime = function getTime() {
                    new Date().getTime();
                };
                var now = getTime();
                var remainingTime = throttle - (now - this._previousLoopTime);
                if (remainingTime <= 0 || remainingTime > throttle) {
                    if (this._loopTimeout) {
                        clearTimeout(this._loopTimeout);
                        this._loopTimeout = null;
                    }
                    this._previousLoopTime = now;
                    this._loopThroughElements();
                } else if (!this._loopTimeout) {
                    this._loopTimeout = setTimeout(function () {
                        this._previousLoopTime = getTime();
                        this._loopTimeout = null;
                        this._loopThroughElements();
                    }.bind(this), remainingTime);
                }
            } else {
                this._loopThroughElements();
            }
        },

        update: function update() {
            // Converts to array the nodeset obtained querying the DOM from _queryOriginNode with elements_selector
            this._elements = Array.prototype.slice.call(this._queryOriginNode.querySelectorAll(this._settings.elements_selector));
            this._purgeElements();
            this._loopThroughElements();
            this._startScrollHandler();
        },
        
        updateSources : function updateSources(){
        	this._elements = Array.prototype.slice.call(this._queryOriginNode.querySelectorAll(this._settings.elements_selector));
        	var settings = this._settings,
            elements = this._elements,
            elementsLength = !elements ? 0 : elements.length;
        	
        	for (var i = 0; i < elementsLength; i++) {
                var element = elements[i];
                
                if (settings.skip_invisible && $(element).is(":hidden")) {
                    continue;
                }

                if (isInsideViewport(element, settings.container, settings.threshold) && element) {
                    /* Start loading the image */
                    this._reveal(element);
                }
            }
        },

        destroy: function destroy() {
            window.removeEventListener("resize", this._boundHandleScroll);
            if (this._loopTimeout) {
                clearTimeout(this._loopTimeout);
                this._loopTimeout = null;
            }
            this._stopScrollHandler();
            this._elements = null;
            this._queryOriginNode = null;
            this._settings = null;
        }
    };

    /* Automatic instances creation if required (useful for async script loading!) */
    var autoInitOptions = window.lazyLoadOptions;
    if (autoInitOptions) {
        autoInitialize(LazyLoad, autoInitOptions);
    }

    return LazyLoad;
});
var resizeTime;
var resizeTimeout = false;
var resizeDelayInterval = 200; //milliseconds
var isMobile=false;
var isTablet=false;
var isLargeTablet= false;
var isSafari;
var lazyLoad;
var SCREEN_XS_MAX = 599;
var SCREEN_SM_MAX = 959;
var SCREEN_LARGE_TABLET = 1024;
var mobileOrientation;

$(window).on( "orientationchange", function() {
	window.setTimeout(updateRenditions, 200);
}); 

function updateRenditions(){
	if(typeof $.fn.pv_responsiveImages == 'function') {
		$("body").pv_responsiveImages();
	    $(".cycle-slide:not(.cycle-slide-active) > .boxHome > .responsive_image").hide();
	    if(lazyLoad)
	        lazyLoad.updateSources();
	}
}

function isPortrait() {
	if($(window).width() < $(window).height())
		return true;
	return false;
}

$(document).ready(function(){
	
	runIEcompatibility();
	
	if(typeof modalUrl != 'undefined' && modalUrl != '') {
		createModalButton(modalUrl);
	} 
	if($(window).width() <= SCREEN_XS_MAX){
		isMobile=true;
		if($(window).width() > $(window).height())
			mobileOrientation = "landscape";
		else
			mobileOrientation = "portrait";
	}
	
	if($(window).width() <= SCREEN_SM_MAX){
		isTablet=true;
		if($(window).width() > $(window).height())
			mobileOrientation = "landscape";
		else
			mobileOrientation = "portrait";
	}

	if ($(window).width() <= SCREEN_LARGE_TABLET) {
		isLargeTablet = true;
	}
	
	//close modals when you click outside popup content 
	$(document.body).on('click', '.mfp-wrap', function (e) {
		if (($(e.target).hasClass('mfp-container') || $(e.target).hasClass('mfp-content')) && $(e.target).has("#errorMessageNIA").length == 0) {
			var magnificPopup = $.magnificPopup.instance;
			magnificPopup.close();
		}
	});
	
	//close modals when you click on the icon
	$(document).on('click','#appFormSentMessage .icon_message > img, #appFormErrorMessage .icon_message > img', function(e){
		var magnificPopup = $.magnificPopup.instance; 
  		magnificPopup.close(); 
	});
	
	isSafari = (navigator.vendor != undefined) && navigator.vendor.indexOf("Apple")==0 && /\sSafari\//.test(navigator.userAgent);
	
	$(window).on("resize", function(){
		if(!isTouchUI) {
			resizeDelayHandling();
		}
	});
	
    //accordions
    addAccordionsClickEvents();

	$.templateStore = function(name, template) {
		if (template !== undefined) {
			$.templateStore[name] = template;
		}
		return $.templateStore[name];
	};

	$.tmplHandlebars = function(tmpl, tmplData) {
		var templateString = $.templateStore[tmpl] || tmpl;
		if (!Array.isArray(tmplData)) {
			tmplData = [tmplData];
		}
		templateString = '{{#each this}}\n' + templateString + '\n{{/each}}';
		var response = $.ajax({
			url: '/cwa/HandlebarsTmpl',
			type: 'POST',
			data: JSON.stringify({
				template: templateString,
				templateData: tmplData
			}),
			processData: false,
			contentType: 'text/plain; charset=UTF-8',
			async: false
		})
		var compiledHtml = response.responseText;
		return $(compiledHtml);
	};

	$.fn.tmplHandlebars = function(data) {
		return $.tmplHandlebars(this.html(), data);
	};
}); //end document ready

/*
 * make a modal from a div from page 
 * example in page: <div id="pkgConfigErrorMessage" class="modal-box white-bg mfp-hide modal-small-notification">...text...</div>
 * call like: showPopupMessage("#pkgConfigErrorMessage");
 */

function showPopupMessage(element){
	$.magnificPopup.open({
		items: {
			src: element, 
			type: 'inline'
		},
		fixedContentPos: false,
		fixedBgPos: true,
		overflowY: 'auto',
		closeBtnInside: true,
		closeOnBgClick: false,
		preloader: false,
		midClick: true,
		removalDelay: 300,
		mainClass: 'my-mfp-zoom-in'
	});
}

var globalAmountPCEPopup;
var globalDecimalPCEPopup;

function checkLinkHasPCEParameters(link_href) {
	var parameters;
	if(link_href.indexOf("globalAmountPCEPopup") != -1) {
		parameters = link_href.split("?")[1];
		link_href = link_href.split("?")[0];
	}

	//calculator detail links already have modal.html, so skip them to not have it duplicated
	if (link_href.indexOf(".modal.html") == -1) {
		if(link_href.indexOf(".html") === -1)
			link_href += ".modal.html";
		else
			link_href = link_href.replace(".html", ".modal.html");
	}

	if(parameters) {
		return link_href + "?" + parameters;
	}
	return link_href;
}

function modalInit(){
    $("a[href*='/popupeditpages/']").each(function () {
    	var remote_href;
        var that = $(this);
		remote_href = checkLinkHasPCEParameters(that.attr("href"));
		that.attr("href", remote_href);
        that.on('click', function () {
        	if(getParameterByName("globalAmountPCEPopup", that.attr("href")) != null) {
				globalAmountPCEPopup = getParameterByName("globalAmountPCEPopup", that.attr("href"));
			}
			if(getParameterByName("globalDecimalPCEPopup", that.attr("href")) != null) {
				globalDecimalPCEPopup = getParameterByName("globalDecimalPCEPopup", that.attr("href"));
			}
            remote_href = that.attr("href").replace(".modal.html", ".modal.ajax.html");
            //remove source_page parameter that +will lead to a redirect inside modal pop-up.
            remote_href = remote_href.split("?")[0];
            that.attr("href", remote_href);
            
        });

        that.magnificPopup({
            type: 'ajax',
            midClick: true,
            overflowY: 'scroll',
            removalDelay: 300,
            closeOnBgClick: false,
            mainClass: 'mfp-fade',
            fixedContentPos: true,
            fixedBgPos: true,
            callbacks: {
                parseAjax: function () {
                    //on Safari under iOS the ajaxComplete ajax event is not fired; also ajaxContentAdded callback for magnificPopup is never called
                    if (isSafari) {
                        $('.mfp-fade.mfp-wrap').addClass('mfp-ready');
                    }
                    setTimeout(makeModalTablesResponsive, 200);
                    $("body").css("overflow-y", "hidden");
                    $('div.mfp-wrap').css('-webkit-overflow-scrolling', 'touch');
                    $("div.mfp-wrap").css('overflow-y', 'auto');
                    $("div.main-wrapper").addClass("noprint");
                    $("div.menu_bar").addClass("noprint");
                    $("div.mfp-preloader").addClass("noprint");
                    $("button.mfp-close").addClass("noprint");
                    $("footer").addClass("noprint");
                },
                
                open : function (){
                	if(typeof enableSwipe == 'function')
                		enableSwipe(false);
                },
                
                close: function () {
                	if(typeof enableSwipe == 'function')
                		enableSwipe(true);
                	
                    remote_href = that.attr("href").replace(".modal.ajax.html", ".modal.html");
                    that.attr("href", remote_href);
                    if(typeof parentPath != 'undefined' ) {
                    	addModalSourcePage(that, parentPath);
                    }
                    $('body').css('overflow-y', 'auto');
                    $('div.mfp-wrap').css('-webkit-overflow-scrolling', '');
                }
            }
        });
        if(typeof parentPath != 'undefined' ) {
        	addModalSourcePage(that, parentPath);
        }
        
        //trigger modal open, if the modal exists => validation done in head.jsp
        if(typeof modalUrl != 'undefined' && modalUrl != "" && (that.attr("href").indexOf(modalUrl) != -1)) {
        	//without timeout, modals from application form are loaded through http instead of https. 
        	setTimeout(function() { 
        		that.trigger('click'); 
        	}, 100);
        	//treat the case when there are multiple modals with the same path, displaying only the first occurrence.
        	modalUrl = "";
        }
    });  
}

function makeModalTablesResponsive(){
	$(".modal-box table").each(function(){
		 //skip some that have their own wrapper management
		 if(!($(this).parent().hasClass('table_wrap') || $(this).hasClass('modal_download'))){
			 if(!$(this).parent().hasClass('table-responsive'))
			 {
			 	$(this).wrap( "<div class='table-responsive'></div>" );
			 }
	 	}
	 });
	 const closeButtonModalLabel = window.closeButtonText ?? "Close";
	 $("button.mfp-close").attr("aria-label",closeButtonModalLabel);
	 $("button.mfp-close").on("click", function() {
      	$("div.main-wrapper").removeClass("noprint");
        $("div.menu_bar").removeClass("noprint");
        $("div.mfp-preloader").removeClass("noprint");
        $("button.mfp-close").removeClass("noprint");
        $("footer").removeClass("noprint");

        $.magnificPopup.close();
      });
}
/**
 * Creates a base-64 encoded ASCII string with parent URL and
 * append to modal "source_page" parameter.
 */
function addModalSourcePage(modal, parentURL) {
	var base64URL = btoa(encodeURIComponent(parentURL));
	var modalURL = modal.attr("href");
	if(modalURL.indexOf("?") == -1) {
		modalURL+="?source_page=" ;
	} else {
		modalURL+="&source_page=";
	}
	modalURL+= base64URL;
	modal.attr("href", modalURL);
}

/**
 * For ru calculator modals, that appear only after the result is displayed,
 * it is mandatory to create the modal.
 * @param url
 */
function createModalButton(url) {
	var link = document.createElement('a');
	link.href = url;
	$('footer').after(link);
}

function resizeDelayHandling(){

    resizeTime = new Date();
    if (resizeTimeout === false) {
        resizeTimeout = true;
        setTimeout(resizeEnd, resizeDelayInterval);
    }	
}

function resizeEnd() {
    if (new Date() - resizeTime < resizeDelayInterval) {
        setTimeout(resizeEnd, resizeDelayInterval);
    } else {
        resizeTimeout = false;
        
        callAfterResizeEnd();
    }
}

function callAfterResizeEnd(){
    /*
     * Add here code which should to be called after resize/orientation 
     * */
	if(isMobile || isTablet){
		//Call only for Mobile or Tablet
		orientationChanged();
	}else{
		//Call only For desktop
		resizeOnlyDesktop();
	}
	
	//Call for both Mobile/Tablet and Desktop
	resizeMobileAndDesktop();
}

function resizeMobileAndDesktop(){
	if(typeof productComparisonResize == 'function') {
		productComparisonResize();
	}
	if(typeof recalculateHeaderHeight == 'function') {
		recalculateHeaderHeight();
	}
	if(typeof changeDigitalOrder == 'function') {
		changeDigitalOrder();
	}
    if(typeof trimDescriptionAtResize == 'function'){
        trimDescriptionAtResize();
    }
    if(typeof shoppingCartRecapWidth == 'function'){
    	shoppingCartRecapWidth();
    }
	if(!detectMobile.any){
		updateRenditions();
	}
}

function orientationChanged(){
	var currentOrientation = ($(window).width() > $(window).height()) ? "landscape" : "portrait";
	if(currentOrientation != mobileOrientation){
		mobileOrientation = currentOrientation;
		resizeOnlyMobile();
	}
}

function resizeOnlyMobile(){
	if(typeof fixHeaderHeight == 'function') {
		fixHeaderHeight();
	}
	if(typeof landingSectionHeader != 'undefined') {
		landingSectionHeader.adjustHeight();
	}
    if(isMobile && typeof renderResultsLabelHeight != 'undefined') {
    	renderResultsLabelHeight();
    }
    if(typeof gotoSection != 'undefined') {
    	var section = location.hash.replace('#', '');
	    setTimeout(function () {
	    	gotoSection(section); 
		}, 500);
    }
}

function resizeOnlyDesktop(){
	if(typeof fitHeaderBar == 'function') {
		fitHeaderBar();
	}
}

$.fn.exists = function(){
    return this.length > 0;
}

//accordions
function addAccordionsClickEvents(){
    
	var attr_control = 'data-controls',
		attr_expanded = 'aria-expanded',
		attr_hidden = 'data-hidden',
		$body = $('body');		

	$body.on( 'click', '.js-expandmore-button', function( event ) {
		var $this = $(this),
			$destination = $( '#' + $this.attr(attr_control) );
         
		if ($this.attr(attr_expanded) === 'false') {
			$this.parent().addClass('active');
			$this.addClass('is-opened').attr(attr_expanded, 'true');
			$destination.removeAttr(attr_hidden);
		} 
		else {
			$this.parent().removeClass('active');
			$this.removeClass('is-opened').attr(attr_expanded, 'false');
			$destination.attr(attr_hidden, 'true');
		}
		$this.showAccordionChildren();
		event.preventDefault();
	});
	      
	$body.on( 'click keydown', '.js-expandmore', function( event ) {
		var $this = $(this),
			$target = $(event.target),
			$button_in = $this.find( '.js-expandmore-button' );
	             
		if ( !$target.is($button_in) && !$target.closest($button_in).length ) {
	             
			if ( event.type == 'click' ){
				$button_in.trigger('click');
				return false;
			}
			if ( event.type == 'keydown' && (event.keyCode==13 || event.keyCode==32 )  ){
				$button_in.trigger('click');
				return false;
			}  
		}   
	});
}

function getParameterByName(name, url) {
    if (!url) {
      url = window.location.href;
    }
    url = decodeURIComponent(url);
    name = name.replace(/[\[\]]/g, "\\$&");
    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
        results = regex.exec(url);
    if (!results) {
    	return null;
    }
    if (!results[2]) {
    	return '';
    }
    return decodeURIComponent(results[2]);
}

$.fn.showAccordionChildren = function() {
	var $this = $(this),
		active_id = $this.attr('data-controls'),
		$children = $('#' + active_id + ' .parsys:first > .sm_accordion > .accordion > .js-expandmore > .js-expandmore-button');
    
	if(!$this.parent().hasClass('active')) {
		$this.parent().siblings().find(".new").hide();
		return;
	}
    
	$children.each(function() {
		$(this).showAccordionChildren();
	});
    
    $this.parent().siblings().children(".parsys").children(".new").show();
};

var CQWCMMode = (function() {
	var WCMMODE = {};
	var isCQ = typeof CQ != 'undefined';
	WCMMODE.isEditMode = isCQ ? CQ.WCM.isEditMode(true) : false;
	WCMMODE.isPreviewMode = isCQ ? CQ.WCM.isPreviewMode(true) : false;
	WCMMODE.isDesignMode = isCQ ? CQ.WCM.isDesignMode(true) : false;
	WCMMODE.isAuthor = isCQ || isTouchUI;
	WCMMODE.isPublish = !isTouchUI && !isCQ;
	return WCMMODE;
})();

var checkType = function(instance, type) {
	if(Object.prototype.toString.call(instance) === "[object " + type + "]") {
		return true;
	}
	return false;
};

function runIEcompatibility(){
	
	var checkFindFunction = function() {
		if (!Array.prototype.find) {
			Object.defineProperty(Array.prototype, 'find', {
				value: function(predicate) {

					if (this == null) {
						throw new TypeError('"this" is null or not defined');
					}

					var o = Object(this);
					var len = o.length >>> 0;
					if (typeof predicate !== 'function') {
						throw new TypeError('predicate must be a function');
					}
					var thisArg = arguments[1];
					var k = 0;
					while (k < len) {
						var kValue = o[k];
						if (predicate.call(thisArg, kValue, k, o)) {
							return kValue;
						}
						k++;
					}
					return undefined;
				}
		  });
		}
	};
	
	var checkFindIndexFunction = function() {
		if (!Array.prototype.findIndex) {
			Object.defineProperty(Array.prototype, 'findIndex', {
				value: function(predicate) {
					if (this == null) {
						throw new TypeError('"this" is null or not defined');
					}
					var o = Object(this);
					var len = o.length >>> 0;
					if (typeof predicate !== 'function') {
						throw new TypeError('predicate must be a function');
					}
					var thisArg = arguments[1];
					var k = 0;
					while (k < len) {
						var kValue = o[k];
						if (predicate.call(thisArg, kValue, k, o)) {
							return k;
						}
						k++;
					}
					return -1;
				},
				configurable: true,
				writable: true
			});
		}
	};
	
	if (typeof(navigator.browserInfo) ==='undefined' ) return;

	if(navigator.browserInfo.browser === "Explorer" || navigator.browserInfo.browser === "MSIE"){
		checkFindFunction();
		checkFindIndexFunction();
	}
}


var listSeparators = (function() {
    'use strict';

    function updateListSeparators(pathToListItems) {
        $(pathToListItems + ':not(li:first-child)')
            .removeClass('borderless')
            .each(function(){
                if (isOnAnotherLine($(this))) {
                    $(this).addClass('borderless');
                }
            });
    }

    function isOnAnotherLine($item) {
        return $item.offset().top > $item.prev().offset().top;
    }

    return {
        updateListSeparators: updateListSeparators
    }

})();

function isFocusOn(component){
	var rect = component.getBoundingClientRect();
	return
		rect.top >= 0 &&
		rect.left >= 0 &&
		rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
		rect.right <= (window.innerWidth || document.documentElement.clientWidth);
}
var jPM = null;
var is_select_closing = false;
var currencyJson = '';
var scrollsections = [];
var scrollsectionsPos = [];
var currentSection = '';
var mobileLandscapeHeight = 320;
var navHomeY = 0;
var isFixed = false;
var cookieBannerScrollDownTimmer = 400;
var addressBarHeight = 0;
var windowWidth = 0;

function is_touch_device() {
    return (('ontouchstart' in window) || (navigator.MaxTouchPoints > 0) || (navigator.msMaxTouchPoints > 0));
}

var isMobileHeight=false;
var isMobileKeyboardActive=false;
var isGoToSectionBlocked=false;

var desktopMenuHeight = 110;
var dockedDesktopMenuHeight = 80;
var deltaDesktop = desktopMenuHeight - dockedDesktopMenuHeight;

var tabletMenuHeight = 48;
var dockedTabletMenuHeight = 48;
var deltaTablet = tabletMenuHeight - dockedTabletMenuHeight;

Array.max = function( array ){
    return Math.max.apply( Math, array );
};


function calculateMenuHeight(){
	
	desktopMenuHeight = $("header .header-container .header-row.header-top").innerHeight() + $("header .header-container .header-row.header-bottom").innerHeight();
	dockedDesktopMenuHeight = $("header .header-container .header-row.header-bottom").innerHeight();
	deltaDesktop = desktopMenuHeight - dockedDesktopMenuHeight;
	
	if(isTablet){
		tabletMenuHeight = $("header .header-container .header-row.header-mobile").outerHeight();
		dockedTabletMenuHeight = tabletMenuHeight;
		deltaTablet = tabletMenuHeight - dockedTabletMenuHeight;
	}

}


function removePaddingForSameColorParbases(){

	/*
	go through every parbase
	determine if child is grey / white
	verify if previous is the same grey/white
	if the same color: padding 0 class
	*/
	
	var previous = null;
	
	$('.parbase>div').each(function(i, obj) {		
		//if is the first in tab don't compare with previous
		if($(this).parents().eq(2).hasClass('tab_content') && ($(this).parent().is(':first-child'))){
			previous = null;
		}
		
		//if is calculators result or sm_leftimageparsys, SKIP and RESET PREVIOUS
		if($(this).parent().hasClass('sm_result') || $(this).parent().hasClass('sm_leftimageparsys')){
			previous = null;
			//skip to next loop
			return true;
		}
		
		//if is sm_accordion, SKIP but DON'T RESET PREVIOUS
		if($(this).parent().hasClass('sm_accordion')){				
			//skip to next loop
			return true;
		}
		
		if(($(this).hasClass('grey')) || ($(this).hasClass('tl-grey-bg'))){
			if (previous !== null){
				if(previous.hasClass('grey') || previous.hasClass('tl-grey-bg')){
					previous.addClass('sameColorAsBottom');
					$(this).addClass('sameColorAsTop');
				}
			}	
			previous = $(this); 
		}
		else if(($(this).hasClass('white')) || ($(this).hasClass('tl-white-bg'))){
			if (previous !== null){
				if(previous.hasClass('white') || previous.hasClass('tl-white-bg')){
					previous.addClass('sameColorAsBottom');
					$(this).addClass('sameColorAsTop');
				}
			}	
			previous = $(this);
		}
		else{
			previous = null;
		}
	});
}

$(document).ajaxSend(function(event, request, settings) {
	request.setRequestHeader('CSRFToken', csrf_token);
});

$(document).ready(function () {
    removePaddingForSameColorParbases();
    
	$('#onmobile').prev('.mid_wrapper').attr('id','find').addClass('scrollsection');

	if($(window).height()<360){
        isMobileHeight=true;
    }

	var $deviceBody = $(document.body);
    if(detectMobile.windows.device){
    	$deviceBody.addClass('windows_device');
    }
    else if($deviceBody.hasClass('windows_device')){
    	$deviceBody.removeClass('windows_device');
    }

    if ($("#cards_carousel").length > 0) {
        $("#cards_carousel").jcarousel({
		    scroll:1
		});
    }

    $('.logo').attr('data-section','home').on("click", function(e) {
    	if (!$(this).hasClass('logo-searchpage') && !$(this).hasClass('logo-group') ) {
	    	var data_section=$('.logo').data('section');
			if($('#'+data_section).length>0){
			 	e.preventDefault();
				gotoSection(data_section);

			}
    	}
    });

    //go to the specific component id with an animation
    $('.animated-anchor').on('click',  function(e) {
        //only for anchor
        var $anchorComponentId = $(this).attr('href');
        if ( $anchorComponentId.indexOf("#") != -1){
            e.preventDefault();
            e.stopPropagation();
            $(this).blur();
            var scroll = parseInt($($anchorComponentId).offset().top - 80);

            if((breakpoint == 'md') || (breakpoint == 'lg')) {
                scroll -= 70;
            } else {
                if ($('.crc-mobile-carousel').length > 0) {
                    scroll -= 100;
                }
            }

            $('html, body').animate({
                scrollTop: scroll + 'px'
            }, 500, 'easeInOutQuad');

            $(".tabs_links " + $anchorComponentId + " a").trigger("click");
        } else {
            return;
        }

    });


    $("header div.cards_slide_container #cards_slider div.slide_content div.slide_links a").click(function (e) {

        e.preventDefault();
        if ($(this).attr('href') === '#compare-cards') {

            var el_pos = $("section div.mid_wrapper.compare-cards").position();
            $('html, body').stop().animate({ scrollTop: (el_pos.top - 155) }, 'slow');
        }
    });
    
    //Keep navigation bar at top
	var nav = $('div.nav_container');
	if(nav && nav.length > 0)
	{
		navHomeY = nav.offset().top;
		$(window).scroll(function() {
			stick_navigation();
		});
	}

    var goalsslides = $('#goals_slider').on('cycle-before', function (e, opts) {
        // advance the other slideshow
        goalsslides.not(this).cycle('goto', opts.currSlide);
        $("#goals_slide_thumbs div").removeClass('active');
        if ((opts.currSlide) < ($("#goals_slide_thumbs div").length - 1)) {
            $("#goals_slide_thumbs div:eq(" + (opts.currSlide + 1) + ")").addClass('active');
        } else {
            $("#goals_slide_thumbs div:eq(0)").addClass('active');
        }
    });




    $('#goals_slide_thumbs div').on("mouseenter",function (e) {
        e.preventDefault();
        var index = $(this).index();
        goalsslides.cycle('goto', index);

        $("#goals_slide_thumbs div").removeClass('active');
        $(this).addClass('active');
    });

    $('#goals_slide_thumbs div').on("mouseenter",function (e) {
        e.preventDefault();
        var index = $(this).index();
        goalsslides.cycle('goto', index);

        $("#goals_slide_thumbs div").removeClass('active');
        $(this).addClass('active');
    });

    //Head slider see all thumbs...
    $("button.see_all").on('mouseenter', function (e) {
        e.preventDefault();
        $(this).hide();
		var container=$("header .slide_thumbnails_container");
		if($(this).is('.goals')){
			container=$("header div.goals_slide_thumbnails_container");
		}
		
		var thumbnailBoxHeight = container.attr("data-height");
		if (typeof thumbnailBoxHeight === "undefined" || thumbnailBoxHeight === false || thumbnailBoxHeight === "") {
			thumbnailBoxHeight = "100px";
		}
        container.stop().animate({ height: thumbnailBoxHeight }, 400, function () {
            $("#slide_thumbs_box").fadeIn(300);
            if(lazyLoad){
    			lazyLoad.update();
    		}
            if (container.height() > 50) {
                container.on("mouseleave", function () {
                    $(this).stop().animate({ height: '0px' }, 300, function () {
                        $("#slide_thumbs_box").hide();
                        $("button.see_all").fadeIn(300);
                    });
                });
            }
        });

    });


    $("#site-search").bind('input', function () {
        //Search via ajax etc...

        if ($(this).val().length > 1) {
            $(this).next('span').fadeIn(200);
        } if ($(this).val().length > 2) {
            $("#search-results").fadeIn(400); //Maybe add ajax functions for load similar results on #search-results container
        } else if ($(this).val().length === 0) {
            $(this).next('span').fadeOut(200);
            $("#search-results").fadeOut(300);
        }

    });


    $("span.reset-form").click(function () {
        $("#site-search").val('');
        $("#site-search").focus();
        $(this).fadeOut(100);
        $("#search-results").fadeOut(300);
    });

    $("header div.search #search-results ul.results li a").click(function () {
        $("#search-results").fadeOut(300);
        $("#site-search").val('');
        $("span.reset-form").fadeOut(300);
    });

    //Scroll down to next page
    $("header a.scroll_down").click(function (e) {
        var t_top = $("header").height();
        e.preventDefault();
        $('html, body').stop().animate({ scrollTop: t_top }, 'slow');
    });

    $('header').on("mousemove", function (e) {
        if (e.pageY > ($(this).height() / 3 * 2)) {
            $('header a.scroll_down').fadeIn(500);
        } else {
            $('header a.scroll_down').fadeOut(300);
        }
    });


    /*Header responsive slide and slider related functions end...*/



    //Sticked page scroll up button


    $('a.page_up').click(function (e) {
        e.preventDefault();
        $('html, body').stop().animate({
        	scrollTop: 0
        }, 700, 'easeOutCirc');
        if ($('body').hasClass('scrollsection')) {//homepage template
        	highLightMenu('home')
        	changeHashWithoutScrolling('home');
       }

    });
    //for accesibility purposes on NVDA hover
    $('a.page_up').on("mouseover", function(){
        $(this).focus();
    }).on("mouseleave", function(){
        $(this).blur();
    })

    // green box fix
    $('.sub_detail.contact').find('p').each(function(){
    	var childAmount = $(this).children().length;
    	if(childAmount === 1 && $(this).find('a').length ===1){
    		var elemText = $(this).text();
    		var linkElement = $(this).children('a');
    		var text = elemText.substring(0, elemText.length - linkElement.text().length);
    		var newContent = '<span>'+text+'</span>';
    		$(this).text("").append(newContent).append(linkElement);
    	}
    });


    //Goals FAQ
    $("section div.mid_wrapper div.faq_container ul li div.question a, section div.mid_wrapper div.faq_container ul li div.question h3").click(function (e) {
        var parent_obj = $(this).parent();
        parent_obj.find('div.answer').slideToggle(800, 'swing');
        parent_obj.toggleClass('active');
        return false;
    });

	//resize results for [sm_productcomparison] and [sm_card-comparison]
    fixCardsRowsHeight = function () {
    	
    	var rowMaxHeight = 0;
    	visible_columns_number = $("#card_compare_list .card_data[data-card]:visible").length;
    	rows_number = $("#card_compare_list .card_data[data-card]:visible:first .part_block").length;

    	for(i=0;i<rows_number;i++){
    		rowMaxHeight = 0;
    		for(j=0;j<visible_columns_number;j++){
    			//reset to height auto in case of resize    			
    			$("#card_compare_list .card_data[data-card]:visible:eq("+j+") .inner .part_block:eq("+i+")").css('height','auto');
    			//read height
    			currentHeight = $("#card_compare_list .card_data[data-card]:visible:eq("+j+") .inner .part_block:eq("+i+")").height();
    			if(currentHeight > rowMaxHeight)
    				rowMaxHeight = currentHeight;
    		}
    	//adjust row/columns height
    	for(j=0;j<visible_columns_number;j++){
    	      $("#card_compare_list .card_data[data-card]:visible:eq("+j+") .inner .part_block:eq("+i+")").css('height',rowMaxHeight + 'px');
    	    }
    	}    
    	
	    //===============================
		//height of results header info
		//==================   
		var info = "#card_compare_list .card_data[data-card] .detail_header .info";
		var button = info + ":visible a.button.primary";
		var cardsHeaderMaxHeight = 0;
		
		//back to original before calculate adjustments again
		$(info).css('height','auto');
		$(button).css('margin-top', '20px');		
		
		$(info +":visible").each(function(){
	    	if($(this).height() > cardsHeaderMaxHeight){
	    		cardsHeaderMaxHeight = $(this).height(); 
	    	}
	    });
		//details button alignment fix
		$(button).each(function(){
	    	button_adjustment = cardsHeaderMaxHeight - $(this).parent().height();
	    	if(button_adjustment > 0) 
	    		$(this).css('margin-top', (button_adjustment + 20) +  'px');//20 is default margin-top
	    });
	    //header height fix
		if(cardsHeaderMaxHeight > 0)
			$(info).css('height',cardsHeaderMaxHeight + 'px');    	
    
    	//wait for column to become visible after fadein
		if(typeof fixPlaceholderColumnHeight == 'function') {
			setTimeout(fixPlaceholderColumnHeight,500);
		}
    }
    

    //Cards carousel end...

    //print
    $("a.print, button.print").click(function(e){
        e.preventDefault();
        window.print();
    });

    //positioning slider container
    var wheight = window.innerHeight;

    String.prototype.getHashCode = function(){
        var hashVar = 0;
        var i;
        var character;
        if (this.length === 0) {return hashVar;}
        for (i = 0, l = this.length; i < l; i++) {
        	character  = this.charCodeAt(i);
            hashVar  = ((hashVar<<5)-hashVar)+character;
            hashVar |= 0; // Convert to 32bit integer
        }
        return hashVar;
    };
 
    //checkDomain();

    $('i.material-icons:not([class *= "notranslate"])').addClass("notranslate");
    
    $("a[href][target='_blank']").attr('rel','noopener noreferrer');

}); //Dom ready end...

/*function checkDomain() {
	if (self !== top) {
		var referrer = encodeURIComponent(document.referrer.split("/")[2]);
		//referrer is lost on click browser back button; 
		//save it in SessionStorage on first correct call
		if(referrer != undefined) {
			try {
				localStorage.setItem("referrer", referrer);
			} catch(err) {}
		}
		var currentURL = encodeURIComponent(document.URL.split("/")[2]);
		
		if (referrer === currentURL) {
			document.body.style.display = "block";
		} else {
			if(referrer == undefined) {
				var localReferrer = localStorage.getItem("referrer");
				referrer = (localReferrer != undefined) ? localReferrer : "";
			}
			var dataContent = "country=" + prevent_clickjacking.country + "&referrer=" + referrer;
			document.body.style.display = "none";
			$.ajax({
		        url: '/bin/allowedDomains',
		        type: 'GET',
		        contentType: 'application/json',
		        dataType : 'text',
		        data: dataContent,
		        cache: false,
		        processData: false,
		        success: function(data,status,xhr) {
					if (data != null && data == "true") {
						document.body.style.display = "block";
					} else {
						top.location = self.location;
					}
		        },
		        error: function(data){
		        	top.location = self.location;
		        }
		    });
		}
	}
}*/

function removeA(arr) {
    var what, a = arguments, L = a.length, ax;
    while (L > 1 && arr.length) {
        what = a[--L];
        while ((ax = arr.indexOf(what)) !== -1) {
            arr.splice(ax, 1);
        }
    }
    return arr;
}


function hide_carousel_items() {
    $("#cards_carousel li").each(function () {
        if (!$(this).hasClass('clicked')) {
            $(this).addClass('disabled');
        }
    });
}


function check_status(value, index) {
    if (value === '') {
        $(this).addClass('error');
    }

}

$(window).on("resize", function () {
    if(!isTouchUI) {
        var newWindowWidth = $(window).width();
        if (windowWidth == newWindowWidth) {
            return;
        }
        windowWidth = newWindowWidth;

        if ($(window).width() <= SCREEN_SM_MAX) {
            isTablet = true;
        } else {
            isTablet = false;
        }

        if ($(window).width() <= SCREEN_XS_MAX) {
            isMobile = true;
        } else {
            isMobile = false;
        }

        var timerR;
        //manage scrollbar array for slide - needs to have f_bar and footer_menu in tablet and removed in desktop
        if (scrollsections.length) {
            if (isTablet) {
                footer_scroll_index = scrollsections.indexOf("footer_menu");
                if (footer_scroll_index < 0)
                    scrollsections.push("footer_menu");
                footer_scroll_index = scrollsections.indexOf("f_bar");
                if (footer_scroll_index < 0)
                    scrollsections.push("f_bar");
            } else {
                footer_scroll_index = scrollsections.indexOf("footer_menu");
                if (footer_scroll_index >= 0)
                    scrollsections.splice(footer_scroll_index, 1);
                footer_scroll_index = scrollsections.indexOf("f_bar");
                if (footer_scroll_index >= 0)
                    scrollsections.splice(footer_scroll_index, 1);
            }
        }
    }

}); //Window resize events end..

var pre_sTop = -1;

//Window scroll event


var scrolling;
var mousewheel;

var t;
$(window).scroll(function (e) {
	scrolling = true;
    var sTop = $(this).scrollTop();
    var delta = pre_sTop - sTop;
    pre_sTop = sTop;
	clearTimeout(t);

    if (!isTablet && $('body:animated, html:animated').length == 0) {
        if (sTop > 400) {
            $(".page_up").css('left', 'none');
            $('.page_up').fadeIn();
        } else {
            $('.page_up').fadeOut();
        }
    }
}); //Window scroll event end...

//Function for stick navigation at top of browser..
function stick_navigation() {
	if ($('div.nav_container').length > 0) {
		if ($('header').length > 0) {
		    var nav = $('div.nav_container');
		    var $main_wrapper = $(".main-wrapper");
		    //height section handler
		    var scrollTop = $(window).scrollTop();
		    //consider the case when the cookie banner is present.
		    var shouldBeFixed = (!isTablet) && scrollTop > navHomeY;
		    if (shouldBeFixed && !isFixed) {
			nav.css({
			    position: 'fixed',
			    top: 0,
			    left: 0
			});
			
			$main_wrapper.css({
				'margin-top': dockedDesktopMenuHeight
			});
			
			nav.addClass('sticked');
			
			isFixed = true;
		    }
		    else if (!shouldBeFixed && isFixed) {
				nav.css({
				    position: 'static',
				    left: 0//align back
				});
				
				$main_wrapper.css({
					'margin-top': 0
				});
				
				nav.removeClass('sticked');
				
				isFixed = false;
		    }
		}
	}
}


$.fn.initModalBoxes = function () {
	//call the improved method from ubis fixes
	modalInit();
};


jQuery.fn.fitToParent = function () {
    this.each(function () {
        var width = 1440;
        var height = 900;
        var parentWidth = $(window).width();
        var parentHeight = $(window).height();

        if (width / parentWidth < height / parentHeight) {
            newWidth = parentWidth;
            newHeight = newWidth / width * height;
        }
        else {
            newHeight = parentHeight;
            newWidth = newHeight / height * width;
        }
        if(isTablet){
        	$(this).css({
                height: newHeight-tabletMenuHeight + 'px',
                width: newWidth + 'px'
            });
        }else{
        	$(this).css({
                height: newHeight-desktopMenuHeight + 'px',
                width: newWidth + 'px',
                left: '50%',
                marginLeft: (-newWidth / 2) + 'px'
            });
        }

    });
};

getConfigJson = function(path){
	var returnVal = {};
	$.ajax({
        method: 'get',
        url: path,
        dataType: "json",
        async: false,
        cache: false,
        success: function (data) {
        	returnVal = data;
        },
    	error: function(XMLHttpRequest, textStatus, errorThrown) {
    		console.log("Problem with getting json");
    		console.log(textStatus);
    	    console.log(errorThrown);
    	}
    });
	return returnVal;

};

showFormError = function(obj, msg, dtls){
	errBox = $(obj).parent().parent().find(".form_error_message");

	if($(errBox).css("display")==="none"){

		msg		= "<h3>"+msg+"</h3>";
		dtls	= dtls==="" ? "" : "<p>"+dtls+"</p>";

		$(errBox).html(msg+dtls);
		$(errBox).slideDown(400);

	}else{

		$(errBox).fadeOut(400,function(){
			msg		= "<h3>"+msg+"</h3>";
    		dtls	= dtls==="" ? "" : "<p>"+dtls+"</p>";

    		$(errBox).html(msg+dtls);
    		$(errBox).fadeIn(400);
		});
	}
};
isFormErrorPresent = function(obj){
	var formErrorAcitve = true;
	errBox = $(obj).parent().parent().find(".form_error_message");
	if($(errBox).css("display")==="none"){
		formErrorAcitve = false;
	}
	return formErrorAcitve;
};

hideFormError = function(obj){
	errBox = $(obj).parent().parent().find(".form_error_message");
	errMsg = $(obj).parent().find("span.error");
	errMsg.fadeOut();
	$(errBox).slideUp(400, function(){
		$(errBox).text("");
	});
};

$.fn.isOnScreen = function () {

    var win = $(window);

    var viewport = {
        top: win.scrollTop(),
        left: win.scrollLeft()
    };
    viewport.right = viewport.left + win.width();
    viewport.bottom = viewport.top + win.height();

    var bounds = this.offset();
    bounds.right = bounds.left + this.outerWidth();
    bounds.bottom = bounds.top + this.outerHeight();

    return (!(viewport.right < bounds.left || viewport.left > bounds.right || viewport.bottom < bounds.top || viewport.top > bounds.bottom));

};



jQuery.fn.scrollTo = function (elem, speed) {
    $(this).stop().animate({
        scrollTop: $(this).scrollTop() - $(elem).offset().top + $(elem).offset().top
    }, speed === undefined ? 1000 : speed);
    return this;
};

/* special car */
$('body').on('click', 'div.special_car_carousel ul li a', function() {
	$('div.special_car_carousel ul li a').removeClass('active');
    $(this).addClass('active');

        $('div.special_car_carousel ul li a').removeClass('active');
        $(this).addClass('active');

        var title = $(this).attr('title');
        var text = $(this).attr('data-text');

        $('section div.mid_wrapper div.tabs_wrapper div.tabs_header h1').text(title);
        $('section div.mid_wrapper div.tabs_wrapper div.tabs_header p').text(text);
});

function computeScrollTop(elementTop) {
	first_level_desktop = $('header .header-row.header-bottom').height();
	second_level_desktop = $('header .header-second-level').height();
	header_mobile = $('header .header-mobile').height();
	return (window.innerWidth < SCREEN_SM_MAX) ? 
			elementTop - header_mobile :
			elementTop - first_level_desktop - second_level_desktop;
};

function getSmartbannerHeight(){
 	return $("#smartbanner").hasClass("shown") ? $("#smartbanner").outerHeight() : 0;
 }

function formatCalculatorResultNumbers(){
	//defaults
	var decimals = 0, decimalSeparator = ',', thousandSeparator = " ";
	
	$('[formatNumber]').each(function(){
		decimals = 0;
		textNumber = $(this).text().trim();
		if(textNumber == parseFloat(textNumber)) {
			thousandSeparator 	= $(this).attr('formatNumber').length > 0
								? $(this).attr('formatNumber')
								: thousandSeparator;
			if (textNumber.indexOf('.') > -1 || textNumber.indexOf(',') > -1) {
				if (thousandSeparator === '.') {
					textNumber = textNumber.replace('.', ',');
					$(this).text(textNumber);
				}
				decimalSeparator = (textNumber.indexOf('.') > -1 ) ? '.' : ',';
				parts = textNumber.split(decimalSeparator);
				decimals = parts[1].length;
			}
			$(this).number(true, decimals, decimalSeparator, thousandSeparator);
		}
	});
}

$(document).ready(function(){
	/*
====================================
MD:  
====================================
2+(2+2+2+2+2)  = general + 5 columns
------------------------------------
4+(2+2+2+2) = general + 4 columns
------------------------------------
3+(3+3+3) = general + 3 columns
------------------------------------
4+(4+4) = general + 2 columns
====================================
SM:
====================================
4+(4+4)  
+4+4+4 = general + 5 columns
------------------------------------
4+(4+4)  
+[4]+4 = general + 4 columns
------------------------------------
3+(3+3+3) = general + 3 columns
------------------------------------
4+(4+4) = general + 2 columns
====================================
XS:
====================================
(6+6)+
(6+6)+
(6)+
12 
= 5 columns + general
------------------------------------
(6+6)+
(6+6)
12 
= 4 columns + general
------------------------------------
(6+6)+
(6)
12 
= 3 columns + general
------------------------------------
(6+6)+
12 
= 2 columns + general
*/
	//select 'contact us' section from Footer for Adobe analytics
	$('.content-footer .footer .main-container .icon-box a').on("click", function(){

		var contactType = "telephone";
		if(this.href.indexOf("mailto") != -1){
			contactType = "email";
		}

		var contactUsInformation = {
			"contact_type": contactType,
			"contact_text": this.innerText
		}
		analyticsOnClickContactUsFooter(contactUsInformation);
	});
	if (typeof footer_column_number != 'undefined') {
		var $sm_footer_column = $("footer .footer-bottom div.sm_footer_column");
		$sm_footer_column.addClass("col-xs-24");
		switch(footer_column_number){
			case 3:
				$sm_footer_column.addClass("col-sm-6 col-md-8");
				break;
			case 4:
				$sm_footer_column.addClass("col-sm-6 col-md-6");
				break;
			case 5:
				$sm_footer_column.addClass("col-sm-5 col-md-4");
				break;

		}
	}
	updateFooterLinksBorders();
});

$(window).on("resize", function(){
	updateFooterLinksBorders();
});

function updateFooterLinksBorders() {
	listSeparators.updateListSeparators('footer .footer_bar ul.separators-list li');
	listSeparators.updateListSeparators('footer .footer-about-us ul.separators-list li');
}

function analyticsOnClickContactUsFooter(contactUsInformation) {
	if(typeof utag != "undefined" && typeof utag.link != "undefined" && typeof utag.link == "function") {
		var action = {
			"trackType": "ACTION-BUTTON-CLICK",
			"action_name": "contact us",
			"action_type": "click",
			"action_player": "async action",
			"contact_type": contactUsInformation.contact_type,
			"contact_text": contactUsInformation.contact_text
		}
		//just for testing the 'action' values
		console.log(action);

		utag.link(action);
	}
}
$(window).on('load', function () {
    if (lazyLoad) {
        lazyLoad.update();
    }

    checkFooterPosition();
    scrollToHashID();
});

$(document).ready(function(){
	lazyLoad = new LazyLoad({
	    elements_selector: ".responsive_image",
	    threshold : 100
	});
});

function checkFooterPosition() {
    if (!isMobile && !isTablet) {
        var documentHeight = $(window).height() - $('body').height();
        if (documentHeight > 0) {
            $('footer').css('margin-top', documentHeight + 'px');
        }
    }
}

$(window).on('hashchange', function() {
    var section = decodeURIComponent(location.hash);
    if ($(section).hasClass('vertical-scrolling')) {
        scrollToHashID();
    }
});

function scrollToHashID() {
    var section = decodeURIComponent(location.hash);
    if ($('#home').length || section === '' || !$(section).length) {
        return;
    }
    //prevent browser from scrolling
    $(window).scrollTop(0);

    var scrollHeight = isTablet ? dockedTabletMenuHeight : dockedDesktopMenuHeight;
    var scroll = $(section).offset().top - 2 * scrollHeight;

    $('html, body').animate({
        scrollTop: scroll + 'px'
    }, 500, 'easeInOutQuad');
}

//vars for loading indicators queues (if there are more ajax calls fired simultaneous
var showLoadingAnimationCount = 0;
var hideLoadingAnimationCount = 0;

var arrayLoadingExcludedURLs = ['/post.ucr.getRates.html',
                                'ajax.pws.sendContact.html',
                                '/cwa/GetExchangeRatesSidemenu',
                                '/post.ucr.getMappingUrl.html',
                                '/cwa/PassContactInfoToGolwo'
                                ];

$(document).ajaxSend(function(event, request, settings) {
	
    if(settings.type=='GET'){
        return;
        }
    if(arrayLoadingExcludedURLs.length > 0){
    	for	(index = 0; index < arrayLoadingExcludedURLs.length; index++) {
    	    if(settings.url === arrayLoadingExcludedURLs[index])
    	    	return;
    	}
    }
    
    if (showLoadingAnimationCount === 0) {
        enableLoadingIndicator(settings);
    }
    showLoadingAnimationCount++;
    hideLoadingAnimationCount++;
   
    //
});

function enableLoadingIndicator(settings) {
    setTimeout(showLoadingIndicator, 1000);
}

$(document).ajaxComplete(function(event, request, settings) {
    if(settings.type=='GET'){
        return;
        }
    if(arrayLoadingExcludedURLs.length > 0){
    	for	(index = 0; index < arrayLoadingExcludedURLs.length; index++) {
    	    if(settings.url === arrayLoadingExcludedURLs[index])
    	    	return;
    	}
    }
    if (--hideLoadingAnimationCount === 0) {
        hideLoadingIndicator(); 
    }
    

});

$(document).ready(function(){
	modalInit();
    boxHomeAdjust();
    
    /* -- 'Header Image' component = make image height flexible when it has text / buttons content --*/
    $('.basic_account').children('.sub_header_content').each(function(i) { 
    	$('.basic_account').css('height','auto');
    });

    //wrap section tables inside in responsive div
	 $("section table").each(function(){
		 //skip some that have their own wrapper management
		 if(!($(this).parent().hasClass('table_wrap') || $(this).parent().hasClass('download_list') || $(this).hasClass('downloadlist'))){
			 if(!$(this).parent().hasClass('table-responsive')){
				 $(this).wrap( "<div class='table-responsive'></div>" );
			 }
	 	}
	 });
    
    //hide the cycle pager black when there is only one slide  
    if($( "header span.cycle-pager a").length<=1){
    	$( "header span.cycle-pager a").css('display','none');
    }
    
    //Add padding to container div for avoid overlaping between header and container div when arrow option exist
    if ($('.arrow_container.down.search_arrow_fix').length > 0) {
    		$('section div.ucr-contentpage-parsys').addClass("arrow-container");
    }
    
    
    
});//end document ready

function checkFooterPosition() {
    if (!isMobile && !isTablet) {
        var documentHeight = $(window).height() - $('body').height();
        if (documentHeight > 0) {
            $('footer').css('margin-top', documentHeight + 'px');
        }
    }
}


function showLoadingIndicator() {
    $body = $("body");
    if (!$body.hasClass("loading_complete")) {
        $body.addClass("loading");
    } else{
        $body.removeClass("loading_complete");
    }

}
function hideLoadingIndicator() {
    $body = $("body");
    //hideLoadingAnimationCount--;
    if (hideLoadingAnimationCount === 0) { //complete after all started calls are finished
        if ($body.hasClass("loading")) {
            setTimeout(function(){
                $body.removeClass("loading");
                showLoadingAnimationCount = 0;
            }, 500);
        } else {
            $body.addClass("loading_complete");
        }
    }
        
}

function boxHomeAdjust(){
}


/* set cookie */
function setCookie(c_name, value, exdays)
{
    var exdate = new Date();
    exdate.setDate(exdate.getDate() + exdays);
    var c_value=escape(value) + ((exdays==null) ? "" : "; expires="+exdate.toUTCString()+"; path=/;secure;SameSite=None");
    document.cookie=c_name + "=" + c_value;
}


/* Video gallery thumbnail click event fix */
$(document).on('click', 'div.mid_wrapper div.image_gallery ul.gallery li div.img a', function(e) 
{
    e.preventDefault();
    var video_id = $(this).attr('rel');
    var htm = '<iframe width="100%" height="100%" src="//www.youtube.com/embed/'+ video_id +'?rel=0&autoplay=1" frameborder="0" allowfullscreen></iframe>';
    $('#video_player').html(htm);
    var v_top = $("div.video_bar").offset();
    $( 'html, body' ).animate({ scrollTop : 390 }, 400);
    return false;
});

/*to format a number with separator before decimal point: example mynumber = '15000';
 * use numberSeparatorFormat(mynumber," ") -> will display: 15 000
 * default separator is comma ","
 *   */
function numberSeparatorFormat(nStr, separator) {
	if(separator==null) separator=",";
    nStr += '';
    var x = nStr.split('.');
    var x1 = x[0];
    var x2 = x.length > 1 ? '.' + x[1] : '';
    var rgx = /(\d+)(\d{3})/;
    while (rgx.test(x1)) {
        x1 = x1.replace(rgx, '$1' + separator + '$2');
    }
    return x1 + x2;
}

/**
 * IE 10 customizations
 * */
var b = document.documentElement;
b.setAttribute('data-useragent',  navigator.userAgent);

/**
 * IE 8 js compatibility
 * */
if (!Array.prototype.indexOf)
{
  Array.prototype.indexOf = function(elt /*, from*/)
  {
    var len = this.length >>> 0;

    var from = Number(arguments[1]) || 0;
    from = (from < 0)
         ? Math.ceil(from)
         : Math.floor(from);
    if (from < 0)
      from += len;

    for (; from < len; from++)
    {
      if (from in this &&
          this[from] === elt)
        return from;
    }
    return -1;
  };
}

/**************************************
Applied a bugfix of LinkChecker that leave some <a href>
without processing on publish and links don't work
**************************************/

$(document).ready(function() {
	
	var path = window.location.pathname; 
	
	$("a[href]").each(function() {
		var href = $(this).attr("href");
		if(path.indexOf('/content/') == -1 && href.indexOf('/content/dam/') == -1 && href.indexOf('/content/') != -1 && href.indexOf('.html') != -1) {
			href = href.replace("/content/","");
			href = href.substring(href.indexOf("/"),href.length);
			
			$(this).attr("href", href);
			
		}
		
	})
});

